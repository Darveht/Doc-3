<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clack</title>
  <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-4653147807800151" crossorigin="anonymous"></script>
  <!-- Fuentes e íconos -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />

  <style>
    /* ================================
       Estilos Generales de Clack (Facebook)
       ================================ */
    :root {
      --primary-color: #1877f2;
      --bg-color: #f0f2f5;
      --text-color: #050505;
      --editor-bg: #ffffff;
    }
    .dark-mode {
      --primary-color: #2374e1;
      --bg-color: #18191a;
      --text-color: #e4e6eb;
      --editor-bg: #242526;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Poppins', sans-serif;
      background: var(--primary-color);
      color: var(--text-color);
      min-height: 100vh;
      overflow-x: hidden;
      max-width: 100%;
    }
    /* Responsividad */
    @media (max-width: 768px) {
      .editor-container {
        grid-template-columns: 1fr;
        padding: 0 10px;
        height: auto;
        min-height: calc(100vh - 160px);
      }
      
      /* Header responsivo */
      header {
        padding: 5px 10px;
        flex-wrap: wrap;
      }
      
      header h1 {
        font-size: 1.2rem;
      }
      
      .controls {
        gap: 5px;
      }
      
      .controls button {
        padding: 6px 12px;
        font-size: 12px;
      }
      
      /* Navegación responsiva */
      nav {
        padding: 8px 10px;
        gap: 10px;
        flex-wrap: wrap;
      }
      
      nav a {
        padding: 6px 12px;
        font-size: 14px;
      }
      
      /* Proyectos responsivos */
      .projects-container {
        flex-direction: column;
        gap: 15px;
      }
      
      .project-list {
        width: 100%;
        order: 2;
      }
      
      .project-editor {
        order: 1;
      }
      
      .project-header {
        flex-direction: column;
        gap: 10px;
        align-items: stretch;
      }
      
      .project-header input#projectName {
        margin-right: 0;
        margin-bottom: 10px;
      }
      
      .project-header .project-actions {
        flex-wrap: wrap;
        gap: 5px;
      }
      
      .project-header .project-actions button {
        flex: 1;
        min-width: 0;
        font-size: 12px;
        padding: 8px 10px;
      }
      
      /* Editor tools responsivo */
      .editor-tools {
        flex-direction: column;
        gap: 10px;
        margin: 10px 10px;
      }
      
      .tool-group {
        justify-content: center;
      }
      
      .editor-tools button {
        padding: 10px 15px;
        font-size: 14px;
      }
      
      /* Preview tools responsivo */
      .preview-tools {
        flex-direction: column;
        gap: 8px;
        margin: 10px 10px;
      }
      
      .preview-tools button {
        width: 100%;
        justify-content: center;
      }
      
      /* Editor areas en móvil */
      .editor-area {
        min-height: 250px;
      }
      
      textarea {
        font-size: 16px; /* Previene zoom en iOS */
      }
      
      /* Líneas de números en móvil */
      .line-numbers {
        width: 35px;
        font-size: 12px;
      }
      
      textarea {
        padding-left: 43px;
      }
      
      .syntax-highlight {
        left: 43px;
        font-size: 12px;
      }
    }
    
    @media (max-width: 480px) {
      .editor-container {
        padding: 0 5px;
        gap: 10px;
      }
      
      .project-header .project-actions button {
        font-size: 10px;
        padding: 6px 8px;
      }
      
      .controls button span {
        display: none;
      }
      
      .controls button {
        width: 40px;
        height: 40px;
        padding: 0;
        display: flex;
        align-items: center;
        justify-content: center;
      }
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(24, 119, 242, 0.4); }
      70% { box-shadow: 0 0 0 10px rgba(24, 119, 242, 0); }
      100% { box-shadow: 0 0 0 0 rgba(24, 119, 242, 0); }
    }

    /* Intro y animaciones */
    .intro {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: var(--primary-color);
      display: flex; justify-content: center; align-items: center;
      z-index: 9999; perspective: 1000px;
    }
    .logo {
      font-size: 5rem; color: #fff; text-transform: uppercase; font-weight: bold;
      opacity: 0; animation: logoReveal 2.5s forwards; transform-style: preserve-3d;
    }
    .code-effect {
      position: absolute; width: 100%; height: 100%;
      font-family: monospace; font-size: 1.2rem; color: rgba(255,255,255,0.2);
      overflow: hidden;
    }
    @keyframes logoReveal {
      0% { transform: rotateX(90deg) translateZ(100px); opacity: 0; }
      30% { transform: rotateX(0deg) translateZ(100px); opacity: 0.6; }
      60% { transform: translateZ(100px) scale(1.2); opacity: 0.8; }
      100% { transform: translateZ(0) scale(1); opacity: 1; }
    }
    @keyframes fadeOut { to { opacity: 0; visibility: hidden; } }
    /* Header y controles */
    header {
      background: var(--primary-color);
      padding: 5px 20px;
      display: flex; justify-content: space-between; align-items: center;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); position: sticky; top: 0;
      z-index: 100;
    }
    header h1 {
      margin: 0;
      line-height: 1;
      font-size: 1.5rem;
      display: flex; align-items: center;
      gap: 5px;
    }
    .controls { display: flex; gap: 10px; align-items: center; }
    .controls button {
      display: flex; align-items: center; gap: 6px;
      background: var(--primary-color); color: #fff;
      border: none; padding: 8px 20px;
      border-radius: 6px; cursor: pointer; font-weight: 600;
      transition: all 0.2s;
    }
    .controls button:hover { background: #166fe5; }
    #settingsBtn, #notificationBtn, #searchBtn {
      background: transparent; border: none; color: #fff;
      font-size: 1.5rem; cursor: pointer; padding: 0;
    }
    /* Modal de Login */
    .modal {
      display: none; position: fixed; z-index: 10000; top: 0; left: 0;
      width: 100%; height: 100%; background: var(--primary-color); color: #fff;
    }
    .modal-content {
      width: 100%; height: 100%; display: flex; flex-direction: column;
      justify-content: center; align-items: center; text-align: center; padding: 20px;
    }
    .modal-content h2 { margin-bottom: 10px; font-size: 2rem; }
    .modal-content p { margin-bottom: 20px; font-size: 1.2rem; }
    #githubLoginBtn, #changeLangBtn {
      padding: 15px 25px; font-size: 16px; border: none; border-radius: 8px;
      background: #24292e; color: #fff; cursor: pointer;
      margin-top: 15px; font-weight: 600;
      display: flex; align-items: center; gap: 10px;
      transition: all 0.3s ease; min-width: 280px;
      justify-content: center; box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    }
    #githubLoginBtn:hover { 
      background: #1a1e22; transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(0,0,0,0.3);
    }
    #githubLoginBtn i {
      font-size: 18px; transition: transform 0.3s ease;
    }
    #githubLoginBtn:hover i {
      transform: scale(1.1);
    }
    #changeLangBtn {
      background: #fff; color: var(--primary-color);
      margin-top: 10px; min-width: auto;
    }
    #changeLangBtn:hover { background: #f0f0f0; }
    /* Spinner */
    .spinner {
      border: 8px solid #f3f3f3; border-top: 8px solid #fff;
      border-radius: 50%; width: 60px; height: 60px;
      animation: spin 1s linear infinite; margin-bottom: 20px;
    }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    /* Overlay transición idioma */
    #langTransitionOverlay {
      display: none; position: fixed; z-index: 10500; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.6); overflow: hidden;
    }
    .lang-ball {
      position: absolute; background: #fff; width: 40px; height: 40px;
      border-radius: 50%; opacity: 0.9;
    }
    .ball-left { top: 50%; left: -50px; }
    .ball-right { top: 50%; right: -50px; }
    @keyframes ballLeftAnim {
      0% { transform: rotate(0deg); left: -50px; }
      50% { transform: rotate(360deg); left: 50%; }
      100% { transform: rotate(720deg); left: 120%; }
    }
    @keyframes ballRightAnim {
      0% { transform: rotate(0deg); right: -50px; }
      50% { transform: rotate(360deg); right: 50%; }
      100% { transform: rotate(720deg); right: 120%; }
    }
    .animate-left { animation: ballLeftAnim 2s ease-in-out forwards; }
    .animate-right { animation: ballRightAnim 2s ease-in-out forwards; }
    /* Overlay Scan (Vista Previa) */
    #scanOverlay {
      display: none; position: fixed; z-index: 10500; top: 0; left: 0;
      width: 100%; height: 100%;
      background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, rgba(0,0,0,0.8) 80%);
      opacity: 0; animation: scanEffect 5s forwards;
    }
    @keyframes scanEffect {
      0% { opacity: 0; } 20% { opacity: 1; } 80% { opacity: 1; } 100% { opacity: 0; }
    }
    /* Overlay Ajustes estilo Instagram */
    #settingsOverlay {
      display: none; position: fixed; z-index: 11000; top: 0; left: 0;
      width: 100%; height: 100%; background: var(--bg-color); color: var(--text-color);
      animation: slideUp 0.3s ease;
    }
    
    #settingsOverlay.show {
      display: block;
    }
    
    .settings-header {
      background: var(--editor-bg);
      padding: 15px 20px;
      border-bottom: 1px solid #e0e0e0;
      display: flex;
      align-items: center;
      gap: 15px;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    
    .settings-header .back-btn {
      background: none;
      border: none;
      font-size: 20px;
      color: var(--text-color);
      cursor: pointer;
      padding: 5px;
    }
    
    .settings-header h2 {
      font-size: 18px;
      font-weight: 600;
      margin: 0;
      flex: 1;
    }
    
    .settings-search {
      padding: 15px 20px;
      background: var(--editor-bg);
      border-bottom: 1px solid #e0e0e0;
    }
    
    .settings-search input {
      width: 100%;
      padding: 10px 15px;
      background: #f1f1f1;
      border: none;
      border-radius: 20px;
      font-size: 14px;
      color: var(--text-color);
    }
    
    .settings-search input::placeholder {
      color: #8e8e8e;
    }
    
    .settings-content {
      flex: 1;
      overflow-y: auto;
      background: var(--editor-bg);
    }
    
    .settings-item {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #e0e0e0;
      cursor: pointer;
      transition: background 0.2s ease;
      text-decoration: none;
      color: var(--text-color);
    }
    
    .settings-item:hover {
      background: #f8f8f8;
    }
    
    .settings-item-icon {
      width: 24px;
      height: 24px;
      margin-right: 15px;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 18px;
    }
    
    .settings-item-content {
      flex: 1;
      display: flex;
      flex-direction: column;
    }
    
    .settings-item-title {
      font-size: 16px;
      font-weight: 400;
      margin-bottom: 2px;
    }
    
    .settings-item-subtitle {
      font-size: 13px;
      color: #8e8e8e;
    }
    
    .settings-item-arrow {
      font-size: 14px;
      color: #8e8e8e;
    }
    
    .settings-section-title {
      padding: 20px 20px 10px 20px;
      font-size: 13px;
      font-weight: 600;
      color: #8e8e8e;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }
    
    /* Submenu de idiomas */
    .language-submenu {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--editor-bg);
      z-index: 11001;
      animation: slideUp 0.3s ease;
    }
    
    .language-submenu.show {
      display: block;
    }
    
    .language-option {
      display: flex;
      align-items: center;
      padding: 15px 20px;
      border-bottom: 1px solid #e0e0e0;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    
    .language-option:hover {
      background: #f8f8f8;
    }
    
    .language-option.selected {
      background: #e3f2fd;
    }
    
    .language-option .flag {
      font-size: 20px;
      margin-right: 15px;
      width: 24px;
      text-align: center;
    }
    
    .language-option .name {
      flex: 1;
      font-size: 16px;
    }
    
    .language-option .check {
      color: var(--primary-color);
      font-size: 16px;
    }
    
    /* Bot de Ayuda */
    #helpBotOverlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--editor-bg);
      z-index: 11002;
      flex-direction: column;
    }
    
    #helpBotOverlay.show {
      display: flex;
    }
    
    .chat-header {
      background: var(--primary-color);
      color: white;
      padding: 15px 20px;
      display: flex;
      align-items: center;
      gap: 15px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    
    .chat-header .back-btn {
      background: none;
      border: none;
      color: white;
      font-size: 20px;
      cursor: pointer;
      padding: 5px;
    }
    
    .chat-header .bot-info {
      flex: 1;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .chat-header .bot-avatar {
      width: 40px;
      height: 40px;
      background: white;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--primary-color);
      font-size: 20px;
      animation: pulse 2s infinite;
    }
    
    .chat-header .bot-details h3 {
      margin: 0;
      font-size: 16px;
      font-weight: 600;
    }
    
    .chat-header .bot-details p {
      margin: 0;
      font-size: 12px;
      opacity: 0.9;
    }
    
    .chat-container {
      flex: 1;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }
    
    .chat-messages {
      flex: 1;
      padding: 20px;
      overflow-y: auto;
      background: #f8f9fa;
    }
    
    .message {
      margin-bottom: 15px;
      display: flex;
      animation: messageSlideIn 0.3s ease;
    }
    
    .message.user {
      justify-content: flex-end;
    }
    
    .message.bot {
      justify-content: flex-start;
    }
    
    .message-content {
      max-width: 70%;
      padding: 12px 16px;
      border-radius: 18px;
      position: relative;
      word-wrap: break-word;
    }
    
    .message.user .message-content {
      background: var(--primary-color);
      color: white;
      border-bottom-right-radius: 5px;
    }
    
    .message.bot .message-content {
      background: white;
      color: var(--text-color);
      border: 1px solid #e0e0e0;
      border-bottom-left-radius: 5px;
      box-shadow: 0 1px 3px rgba(0,0,0,0.1);
    }
    
    .message-time {
      font-size: 11px;
      opacity: 0.7;
      margin-top: 5px;
      text-align: right;
    }
    
    .message.bot .message-time {
      text-align: left;
    }
    
    .typing-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      padding: 12px 16px;
      background: white;
      border-radius: 18px;
      border-bottom-left-radius: 5px;
      border: 1px solid #e0e0e0;
      max-width: 70%;
      margin-bottom: 15px;
    }
    
    .typing-dots {
      display: flex;
      gap: 3px;
    }
    
    .typing-dot {
      width: 8px;
      height: 8px;
      background: #999;
      border-radius: 50%;
      animation: typingDot 1.4s infinite;
    }
    
    .typing-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .typing-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    .chat-input-container {
      padding: 15px 20px;
      background: white;
      border-top: 1px solid #e0e0e0;
      display: flex;
      gap: 10px;
      align-items: flex-end;
    }
    
    .chat-input {
      flex: 1;
      border: 1px solid #e0e0e0;
      border-radius: 20px;
      padding: 12px 16px;
      font-size: 14px;
      resize: none;
      min-height: 20px;
      max-height: 100px;
      background: #f8f9fa;
    }
    
    .chat-input:focus {
      outline: none;
      border-color: var(--primary-color);
      background: white;
    }
    
    .send-button {
      background: var(--primary-color);
      color: white;
      border: none;
      border-radius: 50%;
      width: 45px;
      height: 45px;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.2s ease;
    }
    
    .send-button:hover {
      background: #166fe5;
      transform: scale(1.05);
    }
    
    .send-button:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
    }
    
    .quick-questions {
      padding: 10px 20px;
      background: white;
      border-top: 1px solid #e0e0e0;
    }
    
    .quick-questions-title {
      font-size: 12px;
      color: #666;
      margin-bottom: 8px;
      font-weight: 600;
    }
    
    .quick-questions-list {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
    }
    
    .quick-question {
      background: #f0f2f5;
      border: 1px solid #e0e0e0;
      border-radius: 15px;
      padding: 6px 12px;
      font-size: 12px;
      cursor: pointer;
      transition: all 0.2s ease;
      color: var(--text-color);
    }
    
    .quick-question:hover {
      background: var(--primary-color);
      color: white;
      transform: translateY(-1px);
    }
    
    @keyframes messageSlideIn {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes typingDot {
      0%, 60%, 100% {
        transform: translateY(0);
        opacity: 0.5;
      }
      30% {
        transform: translateY(-10px);
        opacity: 1;
      }
    }
    
    /* Selector de idiomas del chat */
    .chat-language-selector {
      position: relative;
    }
    
    .language-selector-btn {
      background: rgba(255,255,255,0.2);
      border: none;
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 5px;
      font-size: 12px;
      transition: all 0.3s ease;
    }
    
    .language-selector-btn:hover {
      background: rgba(255,255,255,0.3);
    }
    
    .chat-language-dropdown {
      position: absolute;
      top: 100%;
      right: 0;
      background: white;
      border-radius: 10px;
      box-shadow: 0 5px 20px rgba(0,0,0,0.2);
      display: none;
      min-width: 150px;
      z-index: 1000;
      overflow: hidden;
      animation: slideDownChat 0.3s ease;
    }
    
    .chat-language-dropdown.show {
      display: block;
    }
    
    .chat-lang-option {
      padding: 12px 15px;
      cursor: pointer;
      transition: background 0.2s ease;
      color: var(--text-color);
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
    }
    
    .chat-lang-option:hover {
      background: #f0f2f5;
    }
    
    .chat-lang-option.selected {
      background: var(--primary-color);
      color: white;
    }
    
    .chat-lang-option::before {
      content: attr(data-flag);
      font-size: 16px;
    }
    
    @keyframes slideDownChat {
      from {
        opacity: 0;
        transform: translateY(-10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    /* Animación skeleton para traducción */
    .message-skeleton {
      background: #f0f0f0;
      border-radius: 18px;
      padding: 12px 16px;
      margin-bottom: 15px;
      max-width: 70%;
      position: relative;
      overflow: hidden;
    }
    
    .message-skeleton::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent);
      animation: skeletonShimmer 1.5s infinite;
    }
    
    .skeleton-line {
      height: 12px;
      background: #e0e0e0;
      border-radius: 6px;
      margin-bottom: 8px;
    }
    
    .skeleton-line:last-child {
      margin-bottom: 0;
      width: 60%;
    }
    
    .translating-indicator {
      display: flex;
      align-items: center;
      gap: 8px;
      color: #666;
      font-size: 12px;
      margin-top: 5px;
    }
    
    .translating-dots {
      display: flex;
      gap: 2px;
    }
    
    .translating-dot {
      width: 4px;
      height: 4px;
      background: var(--primary-color);
      border-radius: 50%;
      animation: translatingPulse 1.4s infinite;
    }
    
    .translating-dot:nth-child(2) {
      animation-delay: 0.2s;
    }
    
    .translating-dot:nth-child(3) {
      animation-delay: 0.4s;
    }
    
    /* Skeleton para página completa */
    #pageSkeletonOverlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--bg-color);
      z-index: 11500;
      overflow: hidden;
    }
    
    .page-skeleton-container {
      padding: 20px;
      height: 100vh;
      overflow-y: auto;
    }
    
    .page-skeleton-header {
      height: 60px;
      background: #e0e0e0;
      border-radius: 8px;
      margin-bottom: 20px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-nav {
      height: 40px;
      background: #e8e8e8;
      border-radius: 6px;
      margin-bottom: 30px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-content {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .page-skeleton-editor {
      height: 400px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-editor::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 30px;
      background: #d0d0d0;
      border-radius: 12px 12px 0 0;
    }
    
    .page-skeleton-tools {
      display: flex;
      gap: 10px;
      margin-bottom: 20px;
      justify-content: center;
      flex-wrap: wrap;
    }
    
    .page-skeleton-tool {
      width: 80px;
      height: 35px;
      background: #e0e0e0;
      border-radius: 6px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-projects {
      display: flex;
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .page-skeleton-project-list {
      width: 250px;
      height: 300px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .page-skeleton-project-editor {
      flex: 1;
      height: 500px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    /* Efecto shimmer para todos los skeletons */
    .page-skeleton-header::before,
    .page-skeleton-nav::before,
    .page-skeleton-editor::after,
    .page-skeleton-tool::before,
    .page-skeleton-project-list::before,
    .page-skeleton-project-editor::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
      animation: skeletonShimmer 1.8s infinite;
    }
    
    /* Skeleton para ajustes */
    .settings-skeleton {
      display: none;
      padding: 20px;
    }
    
    .settings-skeleton-item {
      height: 60px;
      background: #e0e0e0;
      border-radius: 8px;
      margin-bottom: 15px;
      position: relative;
      overflow: hidden;
    }
    
    .settings-skeleton-item::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
      animation: skeletonShimmer 1.8s infinite;
    }
    
    /* Skeleton para proyectos */
    .projects-skeleton {
      display: none;
      padding: 20px;
    }
    
    .projects-skeleton-title {
      height: 40px;
      background: #e0e0e0;
      border-radius: 8px;
      margin-bottom: 30px;
      width: 300px;
      margin-left: auto;
      margin-right: auto;
      position: relative;
      overflow: hidden;
    }
    
    .projects-skeleton-container {
      display: flex;
      gap: 20px;
    }
    
    .projects-skeleton-list {
      width: 250px;
      height: 400px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .projects-skeleton-editor {
      flex: 1;
      height: 600px;
      background: #e0e0e0;
      border-radius: 12px;
      position: relative;
      overflow: hidden;
    }
    
    .projects-skeleton-title::before,
    .projects-skeleton-list::before,
    .projects-skeleton-editor::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
      animation: skeletonShimmer 1.8s infinite;
    }
    
    /* Indicador de traducción global */
    .global-translation-indicator {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.9);
      color: white;
      padding: 20px 30px;
      border-radius: 15px;
      z-index: 12000;
      text-align: center;
      font-family: 'Poppins', sans-serif;
      box-shadow: 0 10px 30px rgba(0,0,0,0.3);
      backdrop-filter: blur(10px);
    }
    
    .global-translation-indicator h3 {
      margin-bottom: 15px;
      font-size: 18px;
      color: #fff;
    }
    
    .global-translation-indicator .translation-progress {
      display: flex;
      align-items: center;
      gap: 10px;
      justify-content: center;
    }
    
    .global-translation-indicator .flag-display {
      font-size: 24px;
      animation: pulse 2s infinite;
    }
    
    @keyframes skeletonShimmer {
      0% {
        left: -100%;
      }
      100% {
        left: 100%;
      }
    }
    
    @keyframes translatingPulse {
      0%, 60%, 100% {
        transform: scale(1);
        opacity: 0.5;
      }
      30% {
        transform: scale(1.2);
        opacity: 1;
      }
    }
    
    @media (max-width: 768px) {
      .settings-header {
        padding: 12px 15px;
      }
      
      .settings-item {
        padding: 12px 15px;
      }
      
      .settings-search {
        padding: 12px 15px;
      }
      
      .settings-section-title {
        padding: 15px 15px 8px 15px;
      }
      
      .chat-messages {
        padding: 15px;
      }
      
      .message-content {
        max-width: 85%;
      }
      
      .chat-input-container {
        padding: 12px 15px;
      }
      
      .quick-questions {
        padding: 8px 15px;
      }
    }
    /* Botón de Soporte dentro de Ajustes */
    #supportOption {
      margin-top: 20px;
      background: #fff;
      color: var(--primary-color);
    }
    
    /* Editor */
    .editor-container {
      max-width: 100%; 
      margin: 0 auto; 
      padding: 20px;
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      height: calc(100vh - 60px);
    }
    .editor-area {
      background: var(--editor-bg); 
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1); 
      overflow: hidden;
      display: flex;
      flex-direction: column;
      height: 100%;
    }
    .editor-area::before {
      content: attr(data-language);
      padding: 8px 16px;
      background: rgba(0,0,0,0.1);
      color: var(--text-color);
      font-size: 12px;
      font-weight: 600;
      text-transform: uppercase;
    }
    .editor-wrapper {
      position: relative;
      height: 100%;
      background: var(--editor-bg);
    }

    .line-numbers {
      width: 45px;
      padding: 16px 8px;
      background: var(--editor-bg);
      color: #666;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      text-align: right;
      user-select: none;
      border-right: 1px solid rgba(0,0,0,0.1);
      white-space: pre;
      position: absolute;
      top: 0;
      left: 0;
      bottom: 0;
      overflow: hidden;
    }

    textarea {
      width: 100%;
      height: 100%;
      padding: 16px 16px 16px 53px;
      border: none;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      tab-size: 2;
      resize: none;
      background: var(--editor-bg);
      color: var(--text-color);
      white-space: pre;
      overflow-wrap: normal;
      overflow-x: auto;
    }

    textarea:focus {
      outline: none;
      background: var(--editor-bg);
    }

    /* Colores de sintaxis */
    .syntax-highlight {
      position: absolute;
      left: 53px;
      top: 16px;
      right: 0;
      bottom: 0;
      padding: 0 16px;
      pointer-events: none;
      color: transparent;
      white-space: pre;
      font-family: 'Monaco', 'Menlo', 'Ubuntu Mono', 'Consolas', monospace;
      font-size: 14px;
      line-height: 1.5;
      z-index: -1;
      background: transparent;
    }

    .syntax-highlight .keyword { color: #C678DD; }
    .syntax-highlight .string { color: #98C379; }
    .syntax-highlight .number { color: #D19A66; }
    .syntax-highlight .function { color: #61AFEF; }
    .syntax-highlight .comment { color: #5C6370; font-style: italic; }
    .dark-mode .editor-area {
      background: #1e1e1e;
    }
    .dark-mode textarea {
      background: #1e1e1e;
      color: #d4d4d4;
    }
    /* Vista Previa y Herramientas */
    .preview-tools {
      display: flex;
      gap: 10px;
      margin: 15px 20px;
      justify-content: center;
    }

    .preview-tools button {
      background: var(--primary-color);
      border: none;
      color: white;
      padding: 10px 20px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-weight: 600;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .preview-tools button:hover {
      background: #166fe5;
      transform: scale(1.05);
    }

    /* Herramientas del Editor */
    .editor-tools {
      display: flex;
      gap: 15px;
      margin: 10px 20px;
      justify-content: center;
      flex-wrap: wrap;
    }

    .tool-group {
      display: flex;
      gap: 5px;
      padding: 5px;
      background: rgba(0,0,0,0.05);
      border-radius: 8px;
    }

    .editor-tools button {
      background: var(--editor-bg);
      border: 1px solid #ddd;
      color: var(--text-color);
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      transition: all 0.3s ease;
      font-size: 12px;
      font-weight: 500;
    }

    .editor-tools button:hover {
      background: var(--primary-color);
      color: white;
      transform: translateY(-2px);
    }

    .project-actions .duplicate-btn {
      background: #28a745;
    }

    .project-actions .duplicate-btn:hover {
      background: #218838;
    }

    .project-actions .export-btn {
      background: #17a2b8;
    }

    .project-actions .export-btn:hover {
      background: #138496;
    }

    .project-actions .fullscreen-btn {
      background: #6f42c1;
    }

    .project-actions .fullscreen-btn:hover {
      background: #5a2d91;
    }

    /* Modo pantalla completa */
    .project-editor.fullscreen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      z-index: 9999;
      background: var(--bg-color);
    }

    .project-editor.fullscreen .editor-container {
      height: calc(100vh - 160px);
    }

    .dark-mode .preview-tools button {
      background: var(--primary-color);
      color: white;
    }

    .dark-mode .preview-tools button:hover {
      background: #166fe5;
    }

    .scan-animation {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 10;
      display: none;
      background: rgba(0,0,0,0.2);
      overflow: hidden;
    }

    .scan-line {
      position: absolute;
      width: 100%;
      height: 2px;
      background: linear-gradient(90deg, transparent, #00ff00, transparent);
      box-shadow: 0 0 10px #00ff00;
      animation: scanMove 3s linear infinite;
    }

    .particles {
      position: absolute;
      width: 100%;
      height: 100%;
    }

    .particle {
      position: absolute;
      background: #00ff00;
      border-radius: 50%;
      pointer-events: none;
      animation: particleFloat 2s linear infinite;
    }

    @keyframes particleFloat {
      0% {
        transform: translateY(0) scale(1);
        opacity: 1;
      }
      100% {
        transform: translateY(-100px) scale(0);
        opacity: 0;
      }
    }

    .code-highlight {
      position: absolute;
      background: rgba(0, 255, 0, 0.2);
      animation: highlight 0.5s ease;
    }

    @keyframes highlight {
      0% { opacity: 0; }
      50% { opacity: 1; }
      100% { opacity: 0; }
    }

    .scan-results {
      position: absolute;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: rgba(0,0,0,0.8);
      padding: 20px;
      border-radius: 10px;
      color: #00ff00;
      font-family: monospace;
      display: none;
    }

    @keyframes scanMove {
      0% { top: 0; }
      100% { top: 100%; }
    }

    .preview-overlay {
      display: none; position: fixed; top: 0; left: 0;
      width: 100%; height: 100%; background: var(--editor-bg);
      z-index: 1000; animation: slideUp 0.3s ease;
    }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    .preview-header {
      background: var(--primary-color); padding: 15px 20px;
      display: flex; justify-content: space-between; align-items: center;
      color: #fff;
    }
    .preview-header button {
      background: transparent; border: none; color: #fff;
      font-size: 1.5rem; cursor: pointer;
    }
    #previewFrame {
      width: 100%; height: calc(100% - 60px); border: none;
      background: var(--editor-bg);
    }
    /* Validación HTML */
    .html-error { border: 2px solid yellow; }
    @keyframes shake {
      0% { transform: translateX(0); }
      25% { transform: translateX(-5px); }
      50% { transform: translateX(5px); }
      75% { transform: translateX(-5px); }
      100% { transform: translateX(0); }
    }
    .shake { animation: shake 0.5s; }
    /* Busqueda (Estilo Twitter/X Moderno) */
    #searchOverlay {
      display: none; position: fixed; z-index: 14000; top: 0; left: 0;
      width: 100%; height: 100%; 
      background: linear-gradient(135deg, #000000 0%, #1a1a1a 100%);
      color: #ffffff; overflow-y: auto; padding: 0;
      animation: searchFadeIn 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }
    
    @keyframes searchFadeIn {
      from { opacity: 0; transform: scale(0.95); }
      to { opacity: 1; transform: scale(1); }
    }
    
    @keyframes searchSlideUp {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    .search-top-bar {
      position: sticky; top: 0; z-index: 100;
      background: rgba(0, 0, 0, 0.95);
      backdrop-filter: blur(20px);
      border-bottom: 1px solid #2f3336;
      padding: 15px 20px;
      display: flex; align-items: center; gap: 15px;
    }
    
    .search-top-bar i { 
      font-size: 1.3rem; cursor: pointer; color: #ffffff;
      transition: all 0.2s ease;
      padding: 8px;
      border-radius: 50%;
    }
    
    .search-top-bar i:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: scale(1.1);
    }
    
    .search-input-container {
      flex: 1;
      position: relative;
      display: flex;
      align-items: center;
      background: #16181c;
      border: 2px solid #2f3336;
      border-radius: 25px;
      padding: 0 20px;
      transition: all 0.3s ease;
      overflow: hidden;
    }
    
    .search-input-container:focus-within {
      border-color: #1d9bf0;
      box-shadow: 0 0 0 1px #1d9bf0;
      background: #000000;
    }
    
    .search-icon {
      color: #71767b;
      margin-right: 12px;
      font-size: 1.1rem;
      transition: color 0.3s ease;
    }
    
    .search-input-container:focus-within .search-icon {
      color: #1d9bf0;
    }
    
    .search-top-bar input {
      flex: 1;
      padding: 15px 0;
      font-size: 1.1rem;
      border: none;
      background: transparent;
      color: #ffffff;
      font-weight: 400;
    }
    
    .search-top-bar input::placeholder {
      color: #71767b;
      font-weight: 400;
    }
    
    .search-top-bar input:focus {
      outline: none;
    }
    
    .search-top-bar button {
      background: linear-gradient(45deg, #1d9bf0, #1a8cd8);
      color: #fff; border: none;
      padding: 12px 24px; border-radius: 25px; cursor: pointer; 
      font-weight: 700; font-size: 15px;
      transition: all 0.3s ease;
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
    }
    
    .search-top-bar button:hover {
      background: linear-gradient(45deg, #1a8cd8, #1d9bf0);
      transform: translateY(-2px);
      box-shadow: 0 6px 20px rgba(29, 155, 240, 0.4);
    }
    
    /* Contenedor principal de búsqueda */
    .search-main-content {
      padding: 0 20px 20px;
      max-width: 1200px;
      margin: 0 auto;
    }
    
    /* Recientes y Tendencias */
    .recent-searches { 
      margin-bottom: 30px;
      animation: searchSlideUp 0.5s ease 0.1s both;
    }
    
    .recent-searches h3 { 
      font-size: 1.4rem; 
      margin-bottom: 15px; 
      color: #ffffff;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .recent-searches h3::before {
      content: "🕒";
      font-size: 1.2rem;
    }
    
    .recent-searches ul { 
      list-style: none; 
      padding: 0; 
      background: #16181c;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid #2f3336;
    }
    
    .recent-searches li {
      cursor: pointer;
      padding: 16px 20px;
      position: relative;
      touch-action: pan-y;
      transition: all 0.3s ease;
      background: #16181c;
      border-bottom: 1px solid #2f3336;
      display: flex;
      align-items: center;
      gap: 12px;
    }
    
    .recent-searches li:last-child {
      border-bottom: none;
    }
    
    .recent-searches li::before {
      content: "🔍";
      font-size: 1rem;
      opacity: 0.7;
    }
    
    .recent-searches li:hover {
      background: #1e2328;
      transform: translateX(4px);
    }
    
    .recent-searches li.swiping {
      transition: none;
    }
    
    .recent-searches li .delete-action {
      position: absolute;
      right: -100px;
      top: 0;
      height: 100%;
      width: 100px;
      background: linear-gradient(45deg, #f91880, #ff4444);
      color: white;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s ease;
      opacity: 0;
      border-radius: 0 16px 16px 0;
    }
    
    .recent-searches li.show-delete .delete-action {
      opacity: 1;
    }
    
    .trending { 
      margin-bottom: 30px;
      animation: searchSlideUp 0.5s ease 0.2s both;
    }
    
    .trending h3 { 
      font-size: 1.4rem; 
      margin-bottom: 15px;
      color: #ffffff;
      font-weight: 700;
      display: flex;
      align-items: center;
      gap: 10px;
    }
    
    .trending h3::before {
      content: "🔥";
      font-size: 1.2rem;
    }
    
    .trending ul { 
      list-style: none; 
      padding: 0;
      background: #16181c;
      border-radius: 16px;
      overflow: hidden;
      border: 1px solid #2f3336;
    }
    
    .trending li {
      cursor: pointer; 
      padding: 18px 20px; 
      border-bottom: 1px solid #2f3336;
      transition: all 0.3s ease;
      position: relative;
      background: #16181c;
    }
    
    .trending li:last-child {
      border-bottom: none;
    }
    
    .trending li:hover {
      background: #1e2328;
      transform: translateX(4px);
    }
    
    .trending li::before {
      content: "📈";
      position: absolute;
      left: 20px;
      top: 50%;
      transform: translateY(-50%);
      font-size: 1rem;
      opacity: 0.8;
    }
    
    .trending li {
      padding-left: 50px;
    }
    
    /* Resultados de Búsqueda */
    .search-results {
      display: grid; 
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: 20px;
      animation: searchSlideUp 0.5s ease 0.3s both;
    }
    
    .video-card {
      background: #16181c; 
      border-radius: 16px; 
      overflow: hidden;
      border: 1px solid #2f3336; 
      display: flex; 
      flex-direction: column;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
    }
    
    .video-card:hover {
      transform: translateY(-4px);
      box-shadow: 0 12px 32px rgba(0, 0, 0, 0.3);
      border-color: #1d9bf0;
    }
    
    .video-card img { 
      width: 100%; 
      height: 200px; 
      object-fit: cover;
      transition: transform 0.3s ease;
    }
    
    .video-card:hover img {
      transform: scale(1.05);
    }
    
    .video-info { 
      padding: 16px 20px; 
      flex: 1;
    }
    
    .video-info h3 { 
      font-size: 1.1rem; 
      margin: 0 0 8px 0; 
      color: #ffffff;
      font-weight: 600;
      line-height: 1.4;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }
    
    .video-actions {
      display: flex; 
      justify-content: space-between; 
      align-items: center;
      padding: 16px 20px; 
      border-top: 1px solid #2f3336;
      background: rgba(0, 0, 0, 0.3);
    }
    
    .video-actions button {
      background: linear-gradient(45deg, #1d9bf0, #1a8cd8);
      color: #fff; 
      border: none;
      padding: 8px 16px; 
      border-radius: 20px; 
      cursor: pointer;
      font-size: 0.9rem;
      font-weight: 600;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      gap: 6px;
    }
    
    .video-actions button:hover {
      background: linear-gradient(45deg, #1a8cd8, #1d9bf0);
      transform: scale(1.05);
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
    }
    
    /* Alternador Videos / Artículos */
    .search-toggle { 
      display: flex; 
      gap: 0; 
      margin-bottom: 25px;
      background: #16181c;
      border-radius: 25px;
      padding: 4px;
      border: 1px solid #2f3336;
      animation: searchSlideUp 0.5s ease both;
    }
    
    .search-toggle button {
      flex: 1; 
      padding: 12px 24px; 
      border: none;
      border-radius: 21px; 
      background: transparent; 
      color: #71767b;
      cursor: pointer; 
      font-weight: 600;
      font-size: 15px;
      transition: all 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94);
      position: relative;
    }
    
    .search-toggle button.active {
      background: linear-gradient(45deg, #1d9bf0, #1a8cd8);
      color: #ffffff;
      box-shadow: 0 4px 12px rgba(29, 155, 240, 0.3);
      transform: scale(1.02);
    }
    
    .search-toggle button:not(.active):hover {
      color: #ffffff;
      background: rgba(255, 255, 255, 0.1);
    }
    
    /* Responsive para móviles */
    @media (max-width: 768px) {
      .search-top-bar {
        padding: 12px 15px;
      }
      
      .search-input-container {
        padding: 0 15px;
      }
      
      .search-top-bar input {
        padding: 12px 0;
        font-size: 1rem;
      }
      
      .search-top-bar button {
        padding: 10px 20px;
        font-size: 14px;
      }
      
      .search-main-content {
        padding: 0 15px 15px;
      }
      
      .search-results {
        grid-template-columns: 1fr;
        gap: 15px;
      }
      
      .recent-searches h3,
      .trending h3 {
        font-size: 1.2rem;
      }
      
      .recent-searches li,
      .trending li {
        padding: 14px 15px;
      }
    }
    /* Reproductor de Video a Pantalla Completa */
    #videoPlayerOverlay {
      display: none; position: fixed; z-index: 15000; top: 0; left: 0;
      width: 100%; height: 100%; background: #fff; flex-direction: column;
      padding: 20px;
    }
    #videoPlayerOverlay iframe {
      width: 100%; 
      height: 100vh;
      margin: 0;
      position: fixed;
      top: 0;
      left: 0;
      z-index: 15001;
    }
    .video-player-actions {
      margin-top: 20px; display: flex; gap: 10px;
      justify-content: center; align-items: center;
    }
    .video-player-actions button {
      background: var(--primary-color); border: none;
      padding: 10px 20px; border-radius: 5px; cursor: pointer;
      font-size: 1rem; color: #fff;
    }
    /* Animación Like */
    .like-animation {
      position: absolute; top: 50%; left: 50%;
      transform: translate(-50%, -50%); font-size: 5rem; color: red;
      opacity: 0; animation: likePop 0.8s forwards; pointer-events: none;
    }
    @keyframes likePop {
      0% { transform: translate(-50%, -50%) scale(0.1); opacity: 0; }
      50% { transform: translate(-50%, -50%) scale(1.2); opacity: 1; }
      100% { transform: translate(-50%, -50%) scale(1); opacity: 0; }
    }
    /* Modal Reportar Video */
    #reportModal {
      display: none; position: fixed; z-index: 16000; top: 0; left: 0;
      width: 100%; height: 100%; background: rgba(0,0,0,0.8);
      justify-content: center; align-items: center; color: #fff; padding: 20px;
    }
    #reportModal .modal-content {
      background: #fff; color: #333; width: 100%; max-width: 500px; padding: 20px;
      border-radius: 8px;
    }
    #reportModal h3 { margin-bottom: 10px; }
    #reportModal label { display: block; margin: 10px 0 5px; }
    #reportModal textarea {
      width: 100%; min-height: 80px; padding: 10px; resize: vertical;
    }
    #reportModal button {
      background: var(--primary-color); color: #fff; border: none;
      padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 10px;
    }
    /* Search Spinner Animation */
    #searchSpinner {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      width: 100px;
      height: 100px;
      z-index: 1000;
    }

    #searchSpinner::before,
    #searchSpinner::after {
      content: '';
      position: absolute;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      background: #1877f2;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      animation: circle-dance 1.5s infinite ease-in-out;
    }

    #searchSpinner::after {
      animation-delay: -0.5s;
      background: #00f2ea;
    }

    @keyframes circle-dance {
      0%, 100% {
        transform: translate(-50%, -50%) rotate(0deg) translateX(30px);
      }
      50% {
        transform: translate(-50%, -50%) rotate(180deg) translateX(30px);
      }
    }

    /* Estilos para botones de artículo */
    .action-btn:hover {
      background: rgba(29, 155, 240, 0.1) !important;
      color: #1d9bf0 !important;
      transform: scale(1.05);
    }

    #likeArticle:hover, #likeArticle.liked {
      background: rgba(249, 24, 128, 0.1) !important;
      color: #f91880 !important;
    }

    #likeArticle.liked i {
      color: #f91880 !important;
    }

    

    #bookmarkArticle:hover, #bookmarkArticle.bookmarked {
      background: rgba(29, 155, 240, 0.1) !important;
      color: #1d9bf0 !important;
    }

    #reportArticle:hover {
      background: rgba(249, 24, 128, 0.1) !important;
      color: #f91880 !important;
    }

    #readerArticle:hover, #readerArticle.reading {
      background: rgba(52, 199, 89, 0.1) !important;
      color: #34c759 !important;
    }

    #readerArticle.reading {
      animation: pulse 2s infinite;
    }

    #closeArticle:hover {
      background: rgba(29, 155, 240, 0.1) !important;
    }

    

    #followAuthor:hover {
      background: #1a8cd8 !important;
      transform: scale(1.05);
    }

    #followAuthor.following {
      background: transparent !important;
      color: #1d9bf0 !important;
      border: 1px solid #1d9bf0 !important;
    }

    /* Efectos para artículos relacionados */
    .related-article-item {
      padding: 15px;
      border: 1px solid #2f3336;
      border-radius: 12px;
      cursor: pointer;
      transition: all 0.3s ease;
      background: #16181c;
    }

    .related-article-item:hover {
      background: #1e2328;
      border-color: #1d9bf0;
      transform: translateY(-2px);
    }

    .article-stats {
      display: flex;
      align-items: center;
      margin-top: 5px;
      font-size: 0.9em;
      color: #666;
    }
    .article-stats i {
      margin-right: 5px;
    }

  /* Selector de idioma flotante */
    #langSelector:hover {
      transform: scale(1.1);
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
    }
    
    #langSelector:active {
      transform: scale(0.95);
    }
    
    @media (max-width: 768px) {
      #langSelector {
        top: 15px;
        right: 15px;
        width: 45px;
        height: 45px;
      }
      
      #langSelector i {
        font-size: 16px;
      }
    }

    /* Estilos para navegación */
    nav {
      background: rgba(24, 119, 242, 0.9);
      padding: 10px 20px;
      display: flex;
      gap: 20px;
      justify-content: center;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    nav a {
      color: white;
      text-decoration: none;
      padding: 8px 16px;
      border-radius: 5px;
      transition: background 0.3s ease;
      font-weight: 500;
    }

    nav a:hover, nav a.active {
      background: rgba(255,255,255,0.2);
    }

    /* Secciones ocultas por defecto */
    .section {
      display: none;
    }

    .section.active {
      display: block;
    }

    /* Editor principal (inicio) */
    #inicio .editor-container {
      max-width: 100%; 
      margin: 0 auto; 
      padding: 20px;
      display: grid; 
      grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
      gap: 20px;
      height: calc(100vh - 120px);
    }

    /* Estilos para la sección de proyectos */
    #proyectos {
      padding: 20px;
      background: var(--bg-color);
      color: var(--text-color);
    }

    #proyectos h2 {
      font-size: 24px;
      margin-bottom: 20px;
      text-align: center;
    }

    .projects-container {
      display: flex;
      gap: 20px;
    }

    .project-list {
      width: 250px;
      background: var(--editor-bg);
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      padding: 15px;
    }

    .project-list button.new-project-btn {
      background: var(--primary-color);
      color: #fff;
      border: none;
      padding: 10px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s ease;
      margin-bottom: 10px;
      width: 100%;
    }

    .project-list button.new-project-btn:hover {
      background: #166fe5;
    }

    #projectsList {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    #projectsList button.project-btn {
      background: #fff;
      color: var(--text-color);
      border: 1px solid #ddd;
      padding: 8px 12px;
      border-radius: 5px;
      cursor: pointer;
      text-align: left;
      transition: background 0.3s ease;
    }

    #projectsList button.project-btn:hover {
      background: #f0f0f0;
    }

    .project-editor {
      flex: 1;
      background: var(--editor-bg);
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0,0,0,0.1);
      overflow: hidden;
    }

    .project-header {
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 15px 20px;
      background: rgba(0,0,0,0.05);
      border-bottom: 1px solid #ddd;
    }

    .project-header input#projectName {
      padding: 8px 12px;
      border: 1px solid #ddd;
      border-radius: 5px;
      font-size: 16px;
      color: var(--text-color);
      background: #fff;
      flex: 1;
      margin-right: 15px;
    }

    .project-header .project-actions {
      display: flex;
      gap: 10px;
    }

    .project-header .project-actions button {
      background: var(--primary-color);
      color: #fff;
      border: none;
      padding: 8px 15px;
      border-radius: 5px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s ease;
    }

    .project-header .project-actions button:hover {
      background: #166fe5;
    }
  </style>
</head>
<body>
  <!-- ===== Intro Animation ===== -->
  <div class="intro">
    <div class="code-effect"></div>
    <h1 class="logo">Clack</h1>
  </div>

  <!-- ===== Modal Login ===== -->
  <div id="loginModal" class="modal">
    <div class="modal-content" id="loginContent">
      <h2 id="modalTitle">Registro / Inicia sesión con GitHub</h2>
      <p id="modalDescription">Inicia sesión como invitado.</p>
      <button id="githubLoginBtn">
        <i class="fa-brands fa-github"></i>
        <span id="loginBtnText">Iniciar sesión con GitHub como invitado</span>
      </button>
      <button id="changeLangBtn">Cambiar Idioma</button>
    </div>
  </div>

  <!-- ===== Overlay Transición Idioma ===== -->
  <div id="langTransitionOverlay">
    <div class="lang-ball ball-left"></div>
    <div class="lang-ball ball-right"></div>
  </div>

  <!-- ===== Overlay Scan (Vista Previa) ===== -->
  <div id="scanOverlay"></div>

  <!-- ===== Overlay Skeleton de Página Completa ===== -->
  <div id="pageSkeletonOverlay">
    <div class="page-skeleton-container">
      <div class="page-skeleton-header"></div>
      <div class="page-skeleton-nav"></div>
      <div class="page-skeleton-content">
        <div class="page-skeleton-editor"></div>
        <div class="page-skeleton-editor"></div>
        <div class="page-skeleton-editor"></div>
      </div>
      <div class="page-skeleton-tools">
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
        <div class="page-skeleton-tool"></div>
      </div>
      <div class="page-skeleton-projects">
        <div class="page-skeleton-project-list"></div>
        <div class="page-skeleton-project-editor"></div>
      </div>
    </div>
    
    <div class="global-translation-indicator">
      <h3>Traduciendo interfaz</h3>
      <div class="translation-progress">
        <span class="flag-display" id="translationFlag">🌐</span>
        <div class="translating-dots">
          <div class="translating-dot"></div>
          <div class="translating-dot"></div>
          <div class="translating-dot"></div>
        </div>
        <span id="translationStatus">Cambiando idioma...</span>
      </div>
    </div>
  </div>

  <!-- ===== Overlay Ajustes estilo Instagram ===== -->
  <div id="settingsOverlay">
    <div class="settings-header">
      <button class="back-btn" id="closeSettings">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>Configuración</h2>
    </div>
    
    <div class="settings-search">
      <input type="text" placeholder="Buscar" id="settingsSearch">
    </div>
    
    <!-- Skeleton para ajustes -->
    <div class="settings-skeleton" id="settingsSkeleton">
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
      <div class="settings-skeleton-item"></div>
    </div>
    
    <div class="settings-content" id="settingsContent">
      <div class="settings-item" id="languageSettingsItem">
        <div class="settings-item-icon">
          <i class="fas fa-globe"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Idioma</div>
          <div class="settings-item-subtitle" id="currentLanguageText">Español</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item" id="themeSettingsItem">
        <div class="settings-item-icon">
          <i class="fas fa-moon" id="themeIcon"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Tema</div>
          <div class="settings-item-subtitle" id="currentThemeText">Claro</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item">
        <div class="settings-item-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Privacidad</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item">
        <div class="settings-item-icon">
          <i class="fas fa-lock"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Seguridad</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-section-title">Información</div>
      
      <div class="settings-item" id="helpBotItem">
        <div class="settings-item-icon">
          <i class="fas fa-robot"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Asistente Virtual</div>
          <div class="settings-item-subtitle">Chat de ayuda en tiempo real</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
      
      <div class="settings-item">
        <div class="settings-item-icon">
          <i class="fas fa-info-circle"></i>
        </div>
        <div class="settings-item-content">
          <div class="settings-item-title">Acerca de</div>
        </div>
        <div class="settings-item-arrow">
          <i class="fas fa-chevron-right"></i>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Submenu de Idiomas ===== -->
  <div id="languageSubmenu" class="language-submenu">
    <div class="settings-header">
      <button class="back-btn" id="backToSettings">
        <i class="fas fa-arrow-left"></i>
      </button>
      <h2>Idioma</h2>
    </div>
    
    <div class="settings-content">
      <div class="language-option" data-lang="es">
        <div class="flag">🇪🇸</div>
        <div class="name">Español</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="en">
        <div class="flag">🇺🇸</div>
        <div class="name">English</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="ja">
        <div class="flag">🇯🇵</div>
        <div class="name">日本語</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="ko">
        <div class="flag">🇰🇷</div>
        <div class="name">한국어</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="vi">
        <div class="flag">🇻🇳</div>
        <div class="name">Tiếng Việt</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
      
      <div class="language-option" data-lang="zh">
        <div class="flag">🇨🇳</div>
        <div class="name">中文</div>
        <div class="check" style="display: none;"><i class="fas fa-check"></i></div>
      </div>
    </div>
  </div>

  <!-- ===== Bot de Ayuda ===== -->
  <div id="helpBotOverlay">
    <div class="chat-header">
      <button class="back-btn" id="closeHelpBot">
        <i class="fas fa-arrow-left"></i>
      </button>
      <div class="bot-info">
        <div class="bot-avatar">
          <i class="fas fa-robot"></i>
        </div>
        <div class="bot-details">
          <h3>Asistente Clack</h3>
          <p>En línea • Siempre disponible</p>
        </div>
      </div>
      <div class="chat-language-selector">
        <button class="language-selector-btn" id="chatLanguageBtn">
          <i class="fas fa-globe"></i>
          <span id="currentChatLang">ES</span>
          <i class="fas fa-chevron-down"></i>
        </button>
        <div class="chat-language-dropdown" id="chatLanguageDropdown">
          <div class="chat-lang-option" data-lang="es" data-flag="🇪🇸">Español</div>
          <div class="chat-lang-option" data-lang="pt" data-flag="🇧🇷">Português</div>
          <div class="chat-lang-option" data-lang="ko" data-flag="🇰🇷">한국어</div>
          <div class="chat-lang-option" data-lang="vi" data-flag="🇻🇳">Tiếng Việt</div>
          <div class="chat-lang-option" data-lang="en" data-flag="🇺🇸">English</div>
        </div>
      </div>
    </div>
    
    <div class="chat-container">
      <div class="chat-messages" id="chatMessages">
        <div class="message bot">
          <div class="message-content">
            ¡Hola! 👋 Soy tu asistente virtual de Clack. Puedo ayudarte con:
            <br><br>
            • 💻 Funciones del editor de código
            • 🎨 Personalización y temas
            • 🔧 Gestión de proyectos
            • 🚀 Vista previa y deployment
            • 🛡️ Análisis de seguridad
            <br><br>
            ¿En qué puedo ayudarte hoy?
            <div class="message-time" id="welcomeTime"></div>
          </div>
        </div>
      </div>
      
      <div class="quick-questions">
        <div class="quick-questions-title">Preguntas frecuentes:</div>
        <div class="quick-questions-list">
          <span class="quick-question" onclick="askQuickQuestion('¿Cómo crear un nuevo proyecto?')">¿Cómo crear un proyecto?</span>
          <span class="quick-question" onclick="askQuickQuestion('¿Cómo cambiar el tema?')">¿Cambiar tema?</span>
          <span class="quick-question" onclick="askQuickQuestion('¿Cómo usar el escáner?')">¿Usar escáner?</span>
          <span class="quick-question" onclick="askQuickQuestion('¿Cómo exportar proyecto?')">¿Exportar proyecto?</span>
          <span class="quick-question" onclick="askQuickQuestion('¿Atajos de teclado?')">¿Atajos?</span>
        </div>
      </div>
      
      <div class="chat-input-container">
        <textarea class="chat-input" id="chatInput" placeholder="Escribe tu pregunta..." rows="1"></textarea>
        <button class="send-button" id="sendButton">
          <i class="fas fa-paper-plane"></i>
        </button>
      </div>
    </div>
  </div>

  <!-- ===== Header ===== -->
  

  <header>
    <h1><i class="fa-solid fa-code"></i> Clack</h1>
    <div class="controls">
      <button id="previewBtn"><i class="fa-solid fa-eye"></i> <span id="previewBtnText">Vista Previa</span></button>
      <button id="searchBtn" title="Buscar"><i class="fa-solid fa-magnifying-glass"></i></button>
      <button id="settingsBtn" title="Ajustes"><i class="fa-solid fa-gear"></i></button>
    </div>
  </header>
    <!-- ===== Navigation ===== -->
    <nav>
        <a href="#" onclick="showSection('inicio')" class="active">Inicio</a>
        <a href="#" onclick="showSection('proyectos')">Proyectos</a>
    </nav>

  <!-- ===== Sección Inicio (Editor Principal) ===== -->
  <section id="inicio" class="section active">
    <div class="editor-container">
      <div class="editor-area" data-language="HTML">
        <div class="editor-wrapper">
          <div class="line-numbers" id="htmlLineNumbersMain">1</div>
          <textarea id="htmlEditorMain" placeholder="Escribe tu código HTML aquí..." spellcheck="false"></textarea>
          <div class="syntax-highlight" id="htmlHighlightMain"></div>
        </div>
      </div>
      <div class="editor-area" data-language="CSS">
        <div class="editor-wrapper">
          <div class="line-numbers" id="cssLineNumbersMain">1</div>
          <textarea id="cssEditorMain" placeholder="Escribe tu código CSS aquí..." spellcheck="false"></textarea>
          <div class="syntax-highlight" id="cssHighlightMain"></div>
        </div>
      </div>
      <div class="editor-area" data-language="javascript">
        <div class="editor-wrapper">
          <div class="line-numbers" id="jsLineNumbersMain">1</div>
          <textarea id="jsEditorMain" placeholder="Escribe tu código JavaScript aquí..." spellcheck="false"></textarea>
          <div class="syntax-highlight" id="jsHighlightMain"></div>
        </div>
      </div>
    </div>
  </section>

  <!-- ===== Proyectos ===== -->
    <section id="proyectos" class="section">
      <h2>Mis Proyectos</h2>
      
      <!-- Skeleton para proyectos -->
      <div class="projects-skeleton" id="projectsSkeleton">
        <div class="projects-skeleton-title"></div>
        <div class="projects-skeleton-container">
          <div class="projects-skeleton-list"></div>
          <div class="projects-skeleton-editor"></div>
        </div>
      </div>
      
      <div class="projects-container" id="projectsContent">
        <div class="project-list">
          <button onclick="createNewProject()" class="new-project-btn">
            <i class="fas fa-plus"></i> Nuevo Proyecto
          </button>
          <div id="projectsList"></div>
        </div>

        <div class="project-editor" id="projectEditor" style="display: none;">
          <div class="project-header">
            <input type="text" id="projectName" placeholder="Nombre del proyecto" />
            <div class="project-actions">
              <button onclick="saveProject()" class="save-btn">
                <i class="fas fa-save"></i> Guardar
              </button>
              <button onclick="duplicateProject()" class="duplicate-btn" title="Duplicar proyecto">
                <i class="fas fa-copy"></i> Duplicar
              </button>
              <button onclick="exportProject()" class="export-btn" title="Exportar proyecto">
                <i class="fas fa-download"></i> Exportar
              </button>
              <button onclick="toggleFullscreen()" class="fullscreen-btn" title="Pantalla completa">
                <i class="fas fa-expand"></i>
              </button>
              <button onclick="closeProject()" class="close-btn">
                <i class="fas fa-times"></i> Cerrar
              </button>
            </div>
          </div>

          <div class="editor-container">
            <div class="editor-area" data-language="HTML">
              <div class="editor-wrapper">
                <div class="line-numbers" id="htmlLineNumbers">1</div>
                <textarea id="htmlEditor" placeholder="Escribe tu código HTML aquí..." spellcheck="false"></textarea>
                <div class="syntax-highlight" id="htmlHighlight"></div>
              </div>
            </div>
            <div class="editor-area" data-language="CSS">
              <div class="editor-wrapper">
                <div class="line-numbers" id="cssLineNumbers">1</div>
                <textarea id="cssEditor" placeholder="Escribe tu código CSS aquí..." spellcheck="false"></textarea>
                <div class="syntax-highlight" id="cssHighlight"></div>
              </div>
            </div>
            <div class="editor-area" data-language="javascript">
              <div class="editor-wrapper">
                <div class="line-numbers" id="jsLineNumbers">1</div>
                <textarea id="jsEditor" placeholder="Escribe tu código JavaScript aquí..." spellcheck="false"></textarea>
                <div class="syntax-highlight" id="jsHighlight"></div>
              </div>
            </div>
          </div>

          <div class="editor-tools">
            <div class="tool-group">
              <button onclick="formatAllCode()" title="Formatear todo el código">
                <i class="fas fa-code"></i> Formatear
              </button>
              <button onclick="findAndReplace()" title="Buscar y reemplazar">
                <i class="fas fa-search"></i> B&R
              </button>
              <button onclick="validateCode()" title="Validar código">
                <i class="fas fa-check-circle"></i> Validar
              </button>
            </div>
            <div class="tool-group">
              <button onclick="undoChanges()" title="Deshacer">
                <i class="fas fa-undo"></i>
              </button>
              <button onclick="redoChanges()" title="Rehacer">
                <i class="fas fa-redo"></i>
              </button>
              <button onclick="clearAllEditors()" title="Limpiar todo">
                <i class="fas fa-trash"></i> Limpiar
              </button>
            </div>
          </div>
          
          <div class="preview-tools">
            <button id="previewBtnProject"><i class="fa-solid fa-eye"></i> <span id="previewBtnTextProject">Vista Previa</span></button>
            <button id="scanBtnProject" title="Escanear seguridad"><i class="fa-solid fa-shield-virus"></i> Escanear</button>
            <button onclick="shareProject()" title="Compartir proyecto">
              <i class="fas fa-share"></i> Compartir
            </button>
            <button onclick="showProjectSettings()" title="Configuraciones del proyecto">
              <i class="fas fa-cog"></i> Config
            </button>
          </div>

          <div id="scanAnimation" class="scan-animation">
            <div class="scan-line"></div>
            <div class="scan-results"></div>
          </div>
        </div>
      </div>
    </section>

  <!-- ===== Vista Previa ===== -->
  <div id="previewOverlay" class="preview-overlay">
    <div class="preview-header">
      <h2 id="previewHeaderText">Vista Previa</h2>
      <div class="preview-tools">
        <button id="zoomInBtn" title="Acercar"><i class="fa-solid fa-magnifying-glass-plus"></i></button>
        <button id="zoomOutBtn" title="Alejar"><i class="fa-solid fa-magnifying-glass-minus"></i></button>
        <button id="scanBtn" title="Escanear seguridad"><i class="fa-solid fa-shield-virus"></i></button>
      </div>
      <button id="closePreview"><i class="fa-solid fa-times"></i></button>
    </div>
    <div id="scanAnimation" class="scan-animation">
      <div class="scan-line"></div>
      <div class="scan-results"></div>
    </div>
    <iframe id="previewFrame"></iframe>
  </div>

  <!-- ===== Overlay de Búsqueda (Estilo Twitter/X Moderno) ===== -->
  <div id="searchOverlay">
    <div class="search-top-bar">
      <i class="fa-solid fa-arrow-left" id="closeSearchOverlay"></i>
      <div class="search-input-container">
        <i class="fa-solid fa-magnifying-glass search-icon"></i>
        <input type="text" id="searchInput" placeholder="Buscar en Clack..." />
        <i class="fa-solid fa-xmark clear-search" id="clearSearch" style="position: absolute; right: 15px; top: 50%; transform: translateY(-50%); color: #71767b; cursor: pointer; display: none; font-size: 16px; padding: 4px; border-radius: 50%; transition: all 0.2s ease;"></i>
      </div>
      <button id="searchExecuteBtn">Buscar</button>
    </div>
    
    <div class="search-main-content">
      <div class="search-toggle">
        <button class="active" id="toggleArticles">📚 Artículos</button>
        <button id="toggleVideos">🎥 Videos</button>
      </div>
      
      <div class="recent-searches">
        <h3>Búsquedas recientes</h3>
        <ul id="recentList"></ul>
      </div>
      
      <div id="searchSpinner" class="search-spinner" style="display:none;"></div>
      <div id="searchResults" class="search-results"></div>
    </div>
  </div>

  <!-- ===== Overlay de Artículo Completo (Estilo Twitter) ===== -->
  <div id="articleOverlay" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #000000; z-index: 16000; overflow-y: auto;">
    <div class="article-container" style="max-width: 600px; margin: 0 auto; background: #000000; min-height: 100vh; position: relative;">
      <!-- Header del artículo -->
      <div class="article-header" style="position: sticky; top: 0; background: rgba(0,0,0,0.95); backdrop-filter: blur(20px); border-bottom: 1px solid #2f3336; padding: 15px 20px; display: flex; align-items: center; gap: 15px; z-index: 100;">
        <button id="closeArticle" style="background: none; border: none; color: #1d9bf0; font-size: 20px; cursor: pointer; padding: 8px; border-radius: 50%; transition: all 0.2s ease;">
          <i class="fas fa-arrow-left"></i>
        </button>
        <h2 style="color: #ffffff; font-size: 18px; font-weight: 700; margin: 0; flex: 1;">Artículo</h2>
      </div>
      
      <!-- Contenido del artículo -->
      <div class="article-content" style="padding: 20px; color: #ffffff; line-height: 1.6;">
        <div class="article-meta" style="display: flex; align-items: center; gap: 12px; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #2f3336;">
          <div class="author-avatar" style="width: 40px; height: 40px; background: linear-gradient(45deg, #1d9bf0, #1a8cd8); border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 16px;">
            W
          </div>
          <div class="author-info">
            <div style="color: #ffffff; font-weight: 600; font-size: 15px;">Wikipedia</div>
            <div style="color: #71767b; font-size: 14px;">Artículo verificado • <span id="articleDate"></span></div>
          </div>
          <button id="followAuthor" style="background: #1d9bf0; color: white; border: none; padding: 6px 16px; border-radius: 20px; font-weight: 600; font-size: 14px; cursor: pointer; margin-left: auto; transition: all 0.2s ease;">
            Seguir
          </button>
        </div>
        
        <h1 id="articleTitle" style="color: #ffffff; font-size: 28px; font-weight: 800; margin-bottom: 20px; line-height: 1.3;"></h1>
        
        <div id="articleBody" style="font-size: 16px; line-height: 1.7; color: #e7e9ea;">
          <!-- Contenido del artículo se carga aquí -->
        </div>
        
        <!-- Acciones del artículo -->
        <div class="article-actions" style="display: flex; align-items: center; gap: 20px; padding: 20px 0; margin-top: 30px; border-top: 1px solid #2f3336;">
          <button class="action-btn" id="likeArticle" style="background: none; border: none; color: #71767b; cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 8px 16px; border-radius: 20px; transition: all 0.2s ease; font-size: 14px;">
            <i class="far fa-heart"></i>
            <span id="likeCount">0</span>
          </button>
          <button class="action-btn" id="bookmarkArticle" style="background: none; border: none; color: #71767b; cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 8px 16px; border-radius: 20px; transition: all 0.2s ease; font-size: 14px;">
            <i class="far fa-bookmark"></i>
            <span>Guardar</span>
          </button>
          <button class="action-btn" id="readerArticle" style="background: none; border: none; color: #71767b; cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 8px 16px; border-radius: 20px; transition: all 0.2s ease; font-size: 14px;">
            <i class="fas fa-volume-up" id="readerIcon"></i>
            <span id="readerText">Lector</span>
          </button>
          <button class="action-btn" id="reportArticle" style="background: none; border: none; color: #71767b; cursor: pointer; display: flex; align-items: center; gap: 8px; padding: 8px 16px; border-radius: 20px; transition: all 0.2s ease; font-size: 14px; margin-left: auto;">
            <i class="fas fa-flag"></i>
            <span>Reportar</span>
          </button>
        </div>
        
        <!-- Artículos relacionados -->
        <div class="related-articles" style="margin-top: 40px; padding-top: 20px; border-top: 1px solid #2f3336;">
          <h3 style="color: #ffffff; font-size: 20px; font-weight: 700; margin-bottom: 20px;">Artículos relacionados</h3>
          <div id="relatedArticlesList" style="display: flex; flex-direction: column; gap: 15px;">
            <!-- Se llenan dinámicamente -->
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ===== Modal de Reporte de Artículo ===== -->
  <div id="reportArticleModal" style="display: none; position: fixed; z-index: 17000; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); justify-content: center; align-items: center; padding: 20px;">
    <div class="modal-content" style="background: #16181c; color: #ffffff; width: 100%; max-width: 500px; padding: 30px; border-radius: 16px; border: 1px solid #2f3336;">
      <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 20px;">
        <h3 style="margin: 0; font-size: 20px; font-weight: 700;">Reportar artículo</h3>
        <button id="closeReportModal" style="background: none; border: none; color: #71767b; font-size: 20px; cursor: pointer; padding: 8px; border-radius: 50%;">
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div style="margin-bottom: 20px;">
        <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea;">Motivo del reporte:</label>
        <select id="reportReason" style="width: 100%; padding: 12px; border: 1px solid #2f3336; border-radius: 8px; background: #000000; color: #ffffff; font-size: 14px;">
          <option value="">Seleccionar motivo</option>
          <option value="spam">Spam o contenido repetitivo</option>
          <option value="misinformation">Información incorrecta</option>
          <option value="inappropriate">Contenido inapropiado</option>
          <option value="copyright">Violación de derechos de autor</option>
          <option value="other">Otro</option>
        </select>
      </div>
      
      <div style="margin-bottom: 25px;">
        <label style="display: block; margin-bottom: 10px; font-weight: 600; color: #e7e9ea;">Detalles adicionales:</label>
        <textarea id="reportDetails" placeholder="Describe el problema (opcional)" style="width: 100%; min-height: 80px; padding: 12px; resize: vertical; border: 1px solid #2f3336; border-radius: 8px; background: #000000; color: #ffffff; font-size: 14px; font-family: inherit;"></textarea>
      </div>
      
      <div style="display: flex; gap: 10px; justify-content: flex-end;">
        <button id="cancelReport" style="background: none; border: 1px solid #2f3336; color: #e7e9ea; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: 600; transition: all 0.2s ease;">
          Cancelar
        </button>
        <button id="submitArticleReport" style="background: #f91880; color: white; border: none; padding: 10px 20px; border-radius: 20px; cursor: pointer; font-weight: 600; transition: all 0.2s ease;">
          Enviar reporte
        </button>
      </div>
    </div>
  </div>

  <!-- ===== Script Principal ===== -->
  <!-- Offline Message -->
  <div id="offlineMessage" style="display: none; position: fixed; bottom: 20px; left: 20px; background: #ff4444; color: white; padding: 10px 20px; border-radius: 5px; z-index: 9999;">
    Estás trabajando sin conexión
  </div>

  <script>
    // Service Worker inline
    if ('serviceWorker' in navigator) {
      const swContent = `
        const CACHE_NAME = 'clack-offline-v1';
        const urlsToCache = [
          '/',
          '/index.html'
        ];

        self.addEventListener('install', event => {
          event.waitUntil(
            caches.open(CACHE_NAME)
              .then(cache => cache.addAll(urlsToCache))
          );
        });

        self.addEventListener('fetch', event => {
          event.respondWith(
            caches.match(event.request)
              .then(response => response || fetch(event.request))
              .catch(() => {
                if (event.request.mode === 'navigate') {
                  return caches.match('/index.html');
                }
              })
          );
        });
      `;

      const blob = new Blob([swContent], {type: 'text/javascript'});
      const swUrl = URL.createObjectURL(blob);

      window.addEventListener('load', () => {
        navigator.serviceWorker.register(swUrl)
          .then(registration => {
            console.log('ServiceWorker registered:', registration);
          })
          .catch(error => {
            console.log('ServiceWorker registration failed:', error);
          });
      });
    }

    // Check online/offline status
    window.addEventListener('online', () => {
      document.getElementById('offlineMessage').style.display = 'none';
    });

    window.addEventListener('offline', () => {
      document.getElementById('offlineMessage').style.display = 'block';
    });

    /*************************************************
     *       CONFIGURACIÓN DE CLAVES API
     *************************************************/
    const YOUTUBE_API_KEY = "AIzaSyDUzRmn9mQ4RL5EwzgExD3CfIzULos76NQ";
    const HUGGINGFACE_API_KEY = "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";
    
    // Configuración de idiomas del chat
    let currentChatLang = 'es';
    const chatLanguages = {
      'es': { name: 'Español', flag: '🇪🇸', code: 'es' },
      'en': { name: 'English', flag: '🇺🇸', code: 'en' },
      'pt': { name: 'Português', flag: '🇧🇷', code: 'pt' },
      'ko': { name: '한국어', flag: '🇰🇷', code: 'ko' },
      'vi': { name: 'Tiếng Việt', flag: '🇻🇳', code: 'vi' }
    };

    // Variables para el lector de artículos
    let speechSynthesis = window.speechSynthesis;
    let currentUtterance = null;
    let isReading = false;
    let availableVoices = [];
    let isTranslating = false;

    // Si no existe un idioma guardado, se usa "es"
    if (!localStorage.getItem('currentLang')) {
      localStorage.setItem('currentLang', 'es');
    }
    let currentLang = localStorage.getItem('currentLang');

    const defaultTranslations = {
      modalTitle: "Registro / Inicia sesión con GitHub",
      modalDescription: "Inicia sesión como invitado.",
      loginButton: "Iniciar sesión con GitHub como invitado",
      previewButton: "Vista Previa",
      htmlPlaceholder: "HTML...",
      cssPlaceholder: "CSS...",
      jsPlaceholder: "JavaScript...",
      previewHeader: "Vista Previa",
      welcomeMessage: "¡Bienvenido a la aplicación! Disfruta del software implementando tus conocimientos de Programación!",
      analyzing: "Analizando...",
      noErrorsFound: "HTML에서 오류가 발견되지 않았습니다!",
      commonErrorsFound: "발견된 일반적인 오류:",
      searchButton: "검색하다",
      searchNoResults: "No se encontraron videos o artículos.",
      like: "Like",
      close: "Cerrar"
    };

    const translations = {
      es: { ...defaultTranslations },
      en: { ...defaultTranslations },
      ja: { ...defaultTranslations },
      ko: { ...defaultTranslations },      vi: { ...defaultTranslations },
      zh: { ...defaultTranslations }
    };

    function getTranslation(key) {
      return translations[currentLang] && translations[currentLang][key] !== undefined 
             ? translations[currentLang][key] 
             : translations["es"][key];
    }

    function updateLanguage(lang) {
      currentLang = lang;
      localStorage.setItem('currentLang', lang);
      
      // Mostrar skeleton de página completa
      showPageSkeleton(lang);
      
      // Simular proceso de traducción
      setTimeout(() => {
        const t = translations[currentLang] || translations["es"];
        
        // Actualizar todos los textos de la interfaz
        updateAllTexts(t);
        
        // Ocultar skeleton después de "traducir"
        setTimeout(() => {
          hidePageSkeleton();
          document.getElementById('settingsOverlay').style.display = 'none';
        }, 1500);
      }, 800);
    }
    
    function showPageSkeleton(lang) {
      const overlay = document.getElementById('pageSkeletonOverlay');
      const flag = document.getElementById('translationFlag');
      const status = document.getElementById('translationStatus');
      
      // Configurar bandera según idioma
      const flags = {
        'es': '🇪🇸',
        'en': '🇺🇸', 
        'ja': '🇯🇵',
        'ko': '🇰🇷',
        'vi': '🇻🇳',
        'zh': '🇨🇳'
      };
      
      const statusTexts = {
        'es': 'Optimizando experiencia...',
        'en': 'Optimizing experience...',
        'ja': 'エクスペリエンスを最適化中...',
        'ko': '경험을 최적화하는 중...',
        'vi': 'Đang tối ưu hóa trải nghiệm...',
        'zh': '正在优化体验...'
      };
      
      flag.textContent = flags[lang] || '🌐';
      status.textContent = statusTexts[lang] || 'Optimizando...';
      
      overlay.style.display = 'block';
      
      // También mostrar skeleton en ajustes si están abiertos
      if (document.getElementById('settingsOverlay').style.display === 'block') {
        showSettingsSkeleton();
      }
      
      // Mostrar skeleton en proyectos si está activo
      if (document.getElementById('proyectos').classList.contains('active')) {
        showProjectsSkeleton();
      }
      
      // Mostrar skeleton en búsqueda si está abierta
      if (document.getElementById('searchOverlay').style.display === 'block') {
        showSearchSkeleton();
      }
      
      // Mostrar skeleton en vista previa si está abierta
      if (document.getElementById('previewOverlay').style.display === 'block') {
        showPreviewSkeleton();
      }
    }
    
    function hidePageSkeleton() {
      const overlay = document.getElementById('pageSkeletonOverlay');
      overlay.style.display = 'none';
      hideSettingsSkeleton();
      hideProjectsSkeleton();
      hideSearchSkeleton();
      hidePreviewSkeleton();
    }
    
    function showSettingsSkeleton() {
      const skeleton = document.getElementById('settingsSkeleton');
      const content = document.getElementById('settingsContent');
      skeleton.style.display = 'block';
      content.style.display = 'none';
    }
    
    function hideSettingsSkeleton() {
      const skeleton = document.getElementById('settingsSkeleton');
      const content = document.getElementById('settingsContent');
      skeleton.style.display = 'none';
      content.style.display = 'block';
    }
    
    function showProjectsSkeleton() {
      const skeleton = document.getElementById('projectsSkeleton');
      const content = document.getElementById('projectsContent');
      skeleton.style.display = 'block';
      content.style.display = 'none';
    }
    
    function hideProjectsSkeleton() {
      const skeleton = document.getElementById('projectsSkeleton');
      const content = document.getElementById('projectsContent');
      skeleton.style.display = 'none';
      content.style.display = 'block';
    }
    
    function showSearchSkeleton() {
      // Crear skeleton dinámico para búsqueda
      const searchOverlay = document.getElementById('searchOverlay');
      let skeleton = document.getElementById('searchSkeleton');
      
      if (!skeleton) {
        skeleton = document.createElement('div');
        skeleton.id = 'searchSkeleton';
        skeleton.style.cssText = `
          position: absolute;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: var(--bg-color);
          z-index: 1;
          padding: 20px;
        `;
        
        skeleton.innerHTML = `
          <div style="height: 60px; background: #e0e0e0; border-radius: 8px; margin-bottom: 20px; position: relative; overflow: hidden;"></div>
          <div style="height: 40px; background: #e8e8e8; border-radius: 6px; margin-bottom: 20px; position: relative; overflow: hidden;"></div>
          <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px;">
            <div style="height: 200px; background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;"></div>
            <div style="height: 200px; background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;"></div>
            <div style="height: 200px; background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;"></div>
          </div>
        `;
        
        // Agregar efecto shimmer a todos los elementos
        const shimmerElements = skeleton.querySelectorAll('div[style*="background: #"]');
        shimmerElements.forEach(el => {
          el.style.position = 'relative';
          el.style.overflow = 'hidden';
          const shimmer = document.createElement('div');
          shimmer.style.cssText = `
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            animation: skeletonShimmer 1.8s infinite;
          `;
          el.appendChild(shimmer);
        });
        
        searchOverlay.appendChild(skeleton);
      }
      
      skeleton.style.display = 'block';
    }
    
    function hideSearchSkeleton() {
      const skeleton = document.getElementById('searchSkeleton');
      if (skeleton) {
        skeleton.style.display = 'none';
      }
    }
    
    function showPreviewSkeleton() {
      // Crear skeleton dinámico para vista previa
      const previewOverlay = document.getElementById('previewOverlay');
      let skeleton = document.getElementById('previewSkeleton');
      
      if (!skeleton) {
        skeleton = document.createElement('div');
        skeleton.id = 'previewSkeleton';
        skeleton.style.cssText = `
          position: absolute;
          top: 60px;
          left: 0;
          width: 100%;
          height: calc(100% - 60px);
          background: var(--bg-color);
          z-index: 1;
          padding: 20px;
        `;
        
        skeleton.innerHTML = `
          <div style="height: 40px; background: #e0e0e0; border-radius: 8px; margin-bottom: 20px; position: relative; overflow: hidden;"></div>
          <div style="height: calc(100vh - 200px); background: #e0e0e0; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="height: 30px; background: #d0d0d0; border-radius: 12px 12px 0 0;"></div>
          </div>
        `;
        
        // Agregar efecto shimmer
        const shimmerElements = skeleton.querySelectorAll('div[style*="background: #"]');
        shimmerElements.forEach(el => {
          el.style.position = 'relative';
          el.style.overflow = 'hidden';
          const shimmer = document.createElement('div');
          shimmer.style.cssText = `
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            animation: skeletonShimmer 1.8s infinite;
          `;
          el.appendChild(shimmer);
        });
        
        previewOverlay.appendChild(skeleton);
      }
      
      skeleton.style.display = 'block';
    }
    
    function hidePreviewSkeleton() {
      const skeleton = document.getElementById('previewSkeleton');
      if (skeleton) {
        skeleton.style.display = 'none';
      }
    }
    
    function updateAllTexts(t) {
      // Actualizar textos del modal
      const modalTitle = document.getElementById('modalTitle');
      const modalDescription = document.getElementById('modalDescription');
      const loginBtnText = document.getElementById('loginBtnText');
      
      if (modalTitle) modalTitle.innerHTML = t.modalTitle;
      if (modalDescription) modalDescription.innerHTML = t.modalDescription;
      if (loginBtnText) loginBtnText.textContent = t.loginButton;
      
      // Actualizar botones
      const previewBtnText = document.getElementById('previewBtnText');
      const previewBtnTextProject = document.getElementById('previewBtnTextProject');
      const previewHeaderText = document.getElementById('previewHeaderText');
      const searchExecuteBtn = document.getElementById('searchExecuteBtn');
      
      if (previewBtnText) previewBtnText.textContent = t.previewButton;
      if (previewBtnTextProject) previewBtnTextProject.textContent = t.previewButton;
      if (previewHeaderText) previewHeaderText.textContent = t.previewHeader;
      if (searchExecuteBtn) searchExecuteBtn.textContent = t.searchButton;
      
      // Actualizar placeholders de editores
      const htmlEditor = document.getElementById('htmlEditor');
      const cssEditor = document.getElementById('cssEditor');
      const jsEditor = document.getElementById('jsEditor');
      const htmlEditorMain = document.getElementById('htmlEditorMain');
      const cssEditorMain = document.getElementById('cssEditorMain');
      const jsEditorMain = document.getElementById('jsEditorMain');
      
      if (htmlEditor) htmlEditor.placeholder = t.htmlPlaceholder;
      if (cssEditor) cssEditor.placeholder = t.cssPlaceholder;
      if (jsEditor) jsEditor.placeholder = t.jsPlaceholder;
      if (htmlEditorMain) htmlEditorMain.placeholder = t.htmlPlaceholder;
      if (cssEditorMain) cssEditorMain.placeholder = t.cssPlaceholder;
      if (jsEditorMain) jsEditorMain.placeholder = t.jsPlaceholder;
      
      // Actualizar navegación y secciones
      updateNavigationTexts(t);
      updateSettingsTexts(t);
      updateProjectsTexts(t);
    }
    
    function updateNavigationTexts(t) {
      // Actualizar textos de navegación según idioma
      const navTexts = {
        'es': { inicio: 'Inicio', proyectos: 'Proyectos' },
        'en': { inicio: 'Home', proyectos: 'Projects' },
        'ja': { inicio: 'ホーム', proyectos: 'プロジェクト' },
        'ko': { inicio: '홈', proyectos: '프로젝트' },
        'vi': { inicio: 'Trang chủ', proyectos: 'Dự án' },
        'zh': { inicio: '首页', proyectos: '项目' }
      };
      
      const texts = navTexts[currentLang] || navTexts['es'];
      const navLinks = document.querySelectorAll('nav a');
      
      if (navLinks[0]) navLinks[0].textContent = texts.inicio;
      if (navLinks[1]) navLinks[1].textContent = texts.proyectos;
    }
    
    function updateSettingsTexts(t) {
      // Actualizar textos de ajustes según idioma
      const settingsTexts = {
        'es': { 
          title: 'Configuración',
          language: 'Idioma',
          theme: 'Tema',
          privacy: 'Privacidad',
          security: 'Seguridad',
          assistant: 'Asistente Virtual',
          about: 'Acerca de'
        },
        'en': { 
          title: 'Settings',
          language: 'Language',
          theme: 'Theme',
          privacy: 'Privacy',
          security: 'Security',
          assistant: 'Virtual Assistant',
          about: 'About'
        },
        'ja': { 
          title: '設定',
          language: '言語',
          theme: 'テーマ',
          privacy: 'プライバシー',
          security: 'セキュリティ',
          assistant: 'バーチャルアシスタント',
          about: 'について'
        },
        'ko': { 
          title: '설정',
          language: '언어',
          theme: '테마',
          privacy: '개인정보',
          security: '보안',
          assistant: '가상 어시스턴트',
          about: '정보'
        },
        'vi': { 
          title: 'Cài đặt',
          language: 'Ngôn ngữ',
          theme: 'Chủ đề',
          privacy: 'Riêng tư',
          security: 'Bảo mật',
          assistant: 'Trợ lý ảo',
          about: 'Giới thiệu'
        },
        'zh': { 
          title: '设置',
          language: '语言',
          theme: '主题',
          privacy: '隐私',
          security: '安全',
          assistant: '虚拟助手',
          about: '关于'
        }
      };
      
      const texts = settingsTexts[currentLang] || settingsTexts['es'];
      
      // Actualizar título de ajustes
      const settingsTitle = document.querySelector('.settings-header h2');
      if (settingsTitle) settingsTitle.textContent = texts.title;
      
      // Actualizar elementos de ajustes
      const settingsItems = document.querySelectorAll('.settings-item-title');
      if (settingsItems[0]) settingsItems[0].textContent = texts.language;
      if (settingsItems[1]) settingsItems[1].textContent = texts.theme;
      if (settingsItems[2]) settingsItems[2].textContent = texts.privacy;
      if (settingsItems[3]) settingsItems[3].textContent = texts.security;
      if (settingsItems[4]) settingsItems[4].textContent = texts.assistant;
      if (settingsItems[5]) settingsItems[5].textContent = texts.about;
    }
    
    function updateProjectsTexts(t) {
      // Actualizar textos de proyectos según idioma
      const projectsTexts = {
        'es': { 
          title: 'Mis Proyectos',
          newProject: 'Nuevo Proyecto',
          save: 'Guardar',
          duplicate: 'Duplicar',
          export: 'Exportar',
          close: 'Cerrar'
        },
        'en': { 
          title: 'My Projects',
          newProject: 'New Project',
          save: 'Save',
          duplicate: 'Duplicate',
          export: 'Export',
          close: 'Close'
        },
        'ja': { 
          title: 'マイプロジェクト',
          newProject: '新しいプロジェクト',
          save: '保存',
          duplicate: '複製',
          export: 'エクスポート',
          close: '閉じる'
        },
        'ko': { 
          title: '내 프로젝트',
          newProject: '새 프로젝트',
          save: '저장',
          duplicate: '복제',
          export: '내보내기',
          close: '닫기'
        },
        'vi': { 
          title: 'Dự án của tôi',
          newProject: 'Dự án mới',
          save: 'Lưu',
          duplicate: 'Sao chép',
          export: 'Xuất',
          close: 'Đóng'
        },
        'zh': { 
          title: '我的项目',
          newProject: '新项目',
          save: '保存',
          duplicate: '复制',
          export: '导出',
          close: '关闭'
        }
      };
      
      const texts = projectsTexts[currentLang] || projectsTexts['es'];
      
      // Actualizar título de proyectos
      const projectsTitle = document.querySelector('#proyectos h2');
      if (projectsTitle) projectsTitle.textContent = texts.title;
      
      // Actualizar botones de proyecto (si existen)
      const newProjectBtn = document.querySelector('.new-project-btn');
      if (newProjectBtn) {
        const icon = newProjectBtn.querySelector('i');
        newProjectBtn.innerHTML = '';
        if (icon) newProjectBtn.appendChild(icon);
        newProjectBtn.append(' ' + texts.newProject);
      }
    }

    function runLangTransitionAnimation() {
      const overlay = document.getElementById('langTransitionOverlay');
      overlay.style.display = 'block';
      const ballLeft = overlay.querySelector('.ball-left');
      const ballRight = overlay.querySelector('.ball-right');
      ballLeft.classList.add('animate-left');
      ballRight.classList.add('animate-right');
      setTimeout(() => {
        overlay.style.display = 'none';
        ballLeft.classList.remove('animate-left');
        ballRight.classList.remove('animate-right');
      }, 2000);
    }

    function setupSwipeDetection() {
      let touchstartX = 0, touchendX = 0;
      const settingsOverlay = document.getElementById('settingsOverlay');
      settingsOverlay.addEventListener('touchstart', e => { touchstartX = e.changedTouches[0].screenX; });
      settingsOverlay.addEventListener('touchend', e => {
        touchendX = e.changedTouches[0].screenX;
        if (touchstartX - touchendX > 100) settingsOverlay.style.display = 'none';
      });
    }

    

    /* ========================
       Funciones de Sesión
       ======================== */
    function checkSession() { if(localStorage.getItem('loggedIn') === 'true') document.getElementById('loginModal').style.display = 'none'; }
    function loginSimulated() {
      localStorage.setItem('loggedIn', 'true');
      document.getElementById('loginModal').style.display = 'none';
    }

    /* ========================
       Funciones de Vista Previa
       ======================== */
    function runScanAnimation() {
      const scanOverlay = document.getElementById('scanOverlay');
      scanOverlay.style.display = 'block';
      scanOverlay.style.animation = 'scanEffect 5s forwards';
      setTimeout(() => { scanOverlay.style.display = 'none'; }, 5000);
    }

    /* ========================
       Validación HTML Simple
       ======================== */

    /* ========================
       Funciones de Búsqueda (YouTube y Wikipedia)
       ======================== */
    function toggleSearchOverlay(show) { document.getElementById('searchOverlay').style.display = show ? 'block' : 'none'; }
    function toggleVideoPlayerOverlay(show, videoId = "") {
      const playerOverlay = document.getElementById('videoPlayerOverlay');
      if (show) {
        playerOverlay.style.display = 'flex';
        document.getElementById('videoPlayerFrame').src = `https://www.youtube.com/embed/${videoId}?autoplay=1`;
      } else {
        playerOverlay.style.display = 'none';
        document.getElementById('videoPlayerFrame').src = "";
      }
    }
    async function searchYouTube() {
      const searchInput = document.getElementById('searchInput').value.trim();
      if (!searchInput) return;

      // Desactivar búsqueda y mostrar mensaje de acceso limitado
      document.getElementById('searchResults').innerHTML = "";
      const limitedAccessModal = document.createElement('div');
      limitedAccessModal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.85);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 20000;
        animation: fadeIn 0.3s ease;
      `;

      const modalContent = document.createElement('div');
      modalContent.style.cssText = `
        background: white;
        padding: 30px;
        border-radius: 15px;
        text-align: center;
        max-width: 90%;
        width: 400px;
        animation: slideUp 0.4s ease;
      `;

      modalContent.innerHTML = `
        <h2 style="margin-bottom: 20px; color: #1877f2;">Querido usuario</h2>
        <p style="margin-bottom: 20px; line-height: 1.5;">Esta función es limitada y ciertos usuarios tienen acceso a esto. ¡Gracias por tu comprensión! Trabajaremos para mejorar más.</p>
        <button style="background: #1877f2; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer;" onclick="this.parentElement.parentElement.remove()">Entendido</button>
      `;

      limitedAccessModal.appendChild(modalContent);
      document.body.appendChild(limitedAccessModal);

      const t = translations[currentLang] || translations["es"];
      document.getElementById('searchSpinner').style.display = 'block';
      document.getElementById('searchResults').innerHTML = "";
      addRecentSearch(searchInput);
      const query = encodeURIComponent(searchInput + " programming");
      const url = `https://www.googleapis.com/youtube/v3/search?part=snippet&q=${query}&type=video&maxResults=6&key=${YOUTUBE_API_KEY}`;
      try {
        const resp = await fetch(url);
        const data = await resp.json();
        document.getElementById('searchSpinner').style.display = 'none';
        if (data.items && data.items.length > 0) {
          const resultsDiv = document.getElementById('searchResults');
          resultsDiv.innerHTML = "";
          data.items.forEach(item => {
            const videoId = item.id.videoId;
            const title = item.snippet.title;
            const thumbnail = item.snippet.thumbnails.medium.url;
            const card = document.createElement('div');
            card.className = 'video-card';
            card.innerHTML = `<img src="${thumbnail}" alt="${title}" />
              <div class="video-info"><h3>${title}</h3></div>
              <div class="video-actions">
                <button data-videoid="${videoId}" class="playVideoBtn">${t.previewButton}</button>
              </div>`;
            resultsDiv.appendChild(card);
          });
          document.querySelectorAll('.playVideoBtn').forEach(btn => {
            btn.addEventListener('click', e => {
              const vid = e.target.getAttribute('data-videoid');
              toggleVideoPlayerOverlay(true, vid);
            });
          });
        } else {
          document.getElementById('searchResults').innerHTML = `<p>${t.searchNoResults}</p>`;
        }
      } catch (err) { console.error("Error buscando en YouTube:", err); document.getElementById('searchSpinner').style.display = 'none'; }
    }
    async function searchWikipedia() {
      const searchInput = document.getElementById('searchInput').value.trim();
      if (!searchInput) return;
      addRecentSearch(searchInput);
      document.getElementById('searchSpinner').style.display = 'block';
      document.getElementById('searchResults').innerHTML = "";
      const url = `https://es.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(searchInput)}&format=json&origin=*`;
      try {
        const resp = await fetch(url);
        const data = await resp.json();
        document.getElementById('searchSpinner').style.display = 'none';
        if (data.query && data.query.search && data.query.search.length > 0) {
          const resultsDiv = document.getElementById('searchResults');
          resultsDiv.innerHTML = "";
          data.query.search.forEach(item => {
            const title = item.title;
            const snippet = item.snippet;
            const card = document.createElement('div');
            card.className = 'video-card';
            card.innerHTML = `<div class="video-info">
              <h3>${title}</h3>
              <div class="article-stats">
                <i class="fas fa-eye" style="color: #1877f2;"></i>
                <span>${Math.floor(Math.random() * 5000 + 1000)} vistas</span>
                ${Math.random() > 0.5 ? '<i class="fas fa-chart-line" style="color: #00f2ea; margin-left: 10px;"></i>' : ''}
              </div>
              <p>${snippet}</p>
              </div>
              <div class="video-actions">
                <button class="openArticleBtn" data-title="${title}">
                  <i class="fas fa-book-reader" style="margin-right: 5px;"></i>
                  Abrir Artículo
                </button>
              </div>`;
            resultsDiv.appendChild(card);
          });
          document.querySelectorAll('.openArticleBtn').forEach(btn => {
            btn.addEventListener('click', e => {
              const title = e.target.getAttribute('data-title');
              const card = e.target.closest('.video-card');
              const snippet = card.querySelector('p').textContent;
              openArticleOverlay(title, snippet);
            });
          });
        } else {
          document.getElementById('searchResults').innerHTML = `<p>${getTranslation("searchNoResults")}</p>`;
        }
      } catch (err) { console.error("Error buscando en Wikipedia:", err); document.getElementById('searchSpinner').style.display = 'none'; }
    }
    function executeSearch() {
      searchWikipedia();
    }

    /* ========================
       Funciones de Búsquedas Recientes y Tendencias
       ======================== */
    function loadRecentSearches() {
      const recent = localStorage.getItem('recentSearches');
      return recent ? JSON.parse(recent) : [];
    }
    function saveRecentSearches(searches) {
      localStorage.setItem('recentSearches', JSON.stringify(searches));
    }
    function addRecentSearch(term) {
      let recent = loadRecentSearches();
      if (!recent.includes(term)) { recent.unshift(term); if(recent.length > 10) recent = recent.slice(0,10); }
      saveRecentSearches(recent);
      renderRecentSearches();
    }
    function renderRecentSearches() {
      const recent = loadRecentSearches();
      const list = document.getElementById('recentList');
      list.innerHTML = "";
      recent.forEach(term => {
        const li = document.createElement('li');
        li.textContent = term;

        // Agregar botón de eliminar
        const deleteAction = document.createElement('div');
        deleteAction.className = 'delete-action';
        deleteAction.innerHTML = '<i class="fas fa-trash"></i>';
        li.appendChild(deleteAction);

        // Variables para el deslizamiento
        let startX = 0;
        let currentX = 0;

        li.addEventListener('touchstart', (e) => {
          startX = e.touches[0].clientX;
          li.classList.add('swiping');
        });

        li.addEventListener('touchmove', (e) => {
          currentX = e.touches[0].clientX;
          const diff = currentX - startX;
          if (diff < 0) { // Solo permitir deslizar hacia la izquierda
            li.style.transform = `translateX(${diff}px)`;
            if (diff < -50) {
              li.classList.add('show-delete');
            } else {
              li.classList.remove('show-delete');
            }
          }
        });

        li.addEventListener('touchend', () => {
          li.classList.remove('swiping');
          const diff = currentX - startX;
          if (diff < -50) {
            // Eliminar la búsqueda
            const searches = loadRecentSearches();
            const newSearches = searches.filter(s => s !== term);
            saveRecentSearches(newSearches);
            li.style.transform = 'translateX(-100%)';
            li.style.opacity = '0';
            setTimeout(() => {
              renderRecentSearches();
            }, 300);
          } else {
            li.style.transform = '';
            li.classList.remove('show-delete');
          }
        });

        li.addEventListener('click', () => { 
          if (!li.classList.contains('show-delete')) {
            document.getElementById('searchInput').value = term; 
            executeSearch(); 
          }
        });

        list.appendChild(li);
      });
    }
    // Funciones de artículos completos
    function openArticleOverlay(title, content) {
      const overlay = document.getElementById('articleOverlay');
      const articleTitle = document.getElementById('articleTitle');
      const articleBody = document.getElementById('articleBody');
      const articleDate = document.getElementById('articleDate');
      
      // Detener cualquier lectura anterior
      if (isReading) {
        stopReading();
      }
      
      // Resetear botón de lector
      updateReaderButton(false);
      
      articleTitle.textContent = title;
      articleDate.textContent = new Date().toLocaleDateString();
      
      // Simular contenido completo del artículo
      articleBody.innerHTML = `
        <p style="margin-bottom: 20px;">${content}</p>
        <p style="margin-bottom: 20px;">Este es un artículo completo con contenido expandido para demostrar la funcionalidad de lectura. En una implementación real, este contenido vendría de la API de Wikipedia con el texto completo del artículo.</p>
        <p style="margin-bottom: 20px;">Los usuarios pueden navegar por el contenido completo, interactuar con funciones como seguir al autor (Wikipedia en este caso), dar like al artículo, guardarlo en favoritos o reportarlo si encuentran contenido inapropiado.</p>
        <p style="margin-bottom: 20px;">La interfaz está diseñada para proporcionar una experiencia de lectura limpia y moderna, enfocándose en el contenido educativo y la facilidad de navegación.</p>
        <p>Al final del artículo, los usuarios pueden encontrar artículos relacionados generados dinámicamente para continuar su exploración del tema.</p>
      `;
      
      // Generar artículos relacionados
      generateRelatedArticles(title);
      
      overlay.style.display = 'block';
      document.body.style.overflow = 'hidden';
    }

    function closeArticleOverlay() {
      const overlay = document.getElementById('articleOverlay');
      overlay.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    async function generateRelatedArticles(mainTitle) {
      const relatedList = document.getElementById('relatedArticlesList');
      
      // Mostrar skeleton de carga
      relatedList.innerHTML = `
        <div style="display: flex; flex-direction: column; gap: 15px;">
          <div style="height: 80px; background: #2f3336; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); animation: skeletonShimmer 1.8s infinite;"></div>
          </div>
          <div style="height: 80px; background: #2f3336; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); animation: skeletonShimmer 1.8s infinite;"></div>
          </div>
          <div style="height: 80px; background: #2f3336; border-radius: 12px; position: relative; overflow: hidden;">
            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent); animation: skeletonShimmer 1.8s infinite;"></div>
          </div>
        </div>
      `;

      try {
        // Buscar artículos relacionados reales usando Wikipedia API
        const searchTerms = mainTitle.split(' ').slice(0, 2).join(' ');
        const url = `https://es.wikipedia.org/w/api.php?action=query&list=search&srsearch=${encodeURIComponent(searchTerms)}&format=json&origin=*&srlimit=4`;
        
        const response = await fetch(url);
        const data = await response.json();
        
        // Esperar un poco para mostrar el skeleton
        await new Promise(resolve => setTimeout(resolve, 1000));
        
        relatedList.innerHTML = '';
        
        if (data.query && data.query.search && data.query.search.length > 0) {
          // Excluir el artículo actual y tomar los primeros 3
          const relatedArticles = data.query.search
            .filter(article => article.title !== mainTitle)
            .slice(0, 3);
          
          relatedArticles.forEach((article, index) => {
            const item = document.createElement('div');
            item.className = 'related-article-item';
            
            // Iconos temáticos dinámicos
            const icons = ['📖', '💡', '🔬', '🌐', '⚡', '🛡️'];
            const randomIcon = icons[index % icons.length];
            
            item.innerHTML = `
              <div style="display: flex; align-items: center; gap: 15px;">
                <div style="width: 60px; height: 60px; background: linear-gradient(45deg, #1d9bf0, #1a8cd8); border-radius: 8px; display: flex; align-items: center; justify-content: center; font-size: 24px;">
                  ${randomIcon}
                </div>
                <div style="flex: 1;">
                  <h4 style="color: #ffffff; font-size: 16px; font-weight: 600; margin: 0 0 5px 0;">${article.title}</h4>
                  <p style="color: #71767b; font-size: 14px; margin: 0; line-height: 1.3;">${article.snippet.substring(0, 80)}...</p>
                  <div style="margin-top: 5px;">
                    <span style="color: #1d9bf0; font-size: 12px;">
                      <i class="fas fa-clock" style="margin-right: 4px;"></i>
                      ${Math.floor(Math.random() * 8) + 3} min de lectura
                    </span>
                  </div>
                </div>
                <i class="fas fa-chevron-right" style="color: #71767b; font-size: 14px;"></i>
              </div>
            `;
            
            item.addEventListener('click', () => {
              openArticleOverlay(article.title, article.snippet);
            });
            
            relatedList.appendChild(item);
          });
        } else {
          // Fallback si no hay resultados de la API
          relatedList.innerHTML = `
            <div style="text-align: center; color: #71767b; padding: 20px;">
              <i class="fas fa-search" style="font-size: 24px; margin-bottom: 10px;"></i>
              <p>No se encontraron artículos relacionados en este momento.</p>
            </div>
          `;
        }
      } catch (error) {
        console.error('Error cargando artículos relacionados:', error);
        relatedList.innerHTML = `
          <div style="text-align: center; color: #71767b; padding: 20px;">
            <i class="fas fa-exclamation-triangle" style="font-size: 24px; margin-bottom: 10px;"></i>
            <p>Error al cargar artículos relacionados.</p>
          </div>
        `;
      }
    }

    function toggleArticleLike() {
      const likeBtn = document.getElementById('likeArticle');
      const likeCount = document.getElementById('likeCount');
      const icon = likeBtn.querySelector('i');
      
      if (likeBtn.classList.contains('liked')) {
        likeBtn.classList.remove('liked');
        icon.className = 'far fa-heart';
        likeCount.textContent = parseInt(likeCount.textContent) - 1;
      } else {
        likeBtn.classList.add('liked');
        icon.className = 'fas fa-heart';
        likeCount.textContent = parseInt(likeCount.textContent) + 1;
        
        // Animación de corazón
        const heart = document.createElement('div');
        heart.innerHTML = '❤️';
        heart.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          font-size: 60px;
          pointer-events: none;
          z-index: 18000;
          animation: likePop 0.8s forwards;
        `;
        document.body.appendChild(heart);
        setTimeout(() => heart.remove(), 800);
      }
    }

    function toggleFollow() {
      const followBtn = document.getElementById('followAuthor');
      
      if (followBtn.classList.contains('following')) {
        followBtn.classList.remove('following');
        followBtn.textContent = 'Seguir';
        followBtn.style.background = '#1d9bf0';
        followBtn.style.color = 'white';
        followBtn.style.border = 'none';
      } else {
        followBtn.classList.add('following');
        followBtn.textContent = 'Siguiendo';
        followBtn.style.background = 'transparent';
        followBtn.style.color = '#1d9bf0';
        followBtn.style.border = '1px solid #1d9bf0';
      }
    }

    function toggleBookmark() {
      const bookmarkBtn = document.getElementById('bookmarkArticle');
      const icon = bookmarkBtn.querySelector('i');
      
      if (bookmarkBtn.classList.contains('bookmarked')) {
        bookmarkBtn.classList.remove('bookmarked');
        icon.className = 'far fa-bookmark';
        bookmarkBtn.querySelector('span').textContent = 'Guardar';
      } else {
        bookmarkBtn.classList.add('bookmarked');
        icon.className = 'fas fa-bookmark';
        bookmarkBtn.querySelector('span').textContent = 'Guardado';
      }
    }

    

    function openReportArticleModal() {
      document.getElementById('reportArticleModal').style.display = 'flex';
    }

    function closeReportArticleModal() {
      document.getElementById('reportArticleModal').style.display = 'none';
      document.getElementById('reportReason').value = '';
      document.getElementById('reportDetails').value = '';
    }

    function submitArticleReport() {
      const reason = document.getElementById('reportReason').value;
      const details = document.getElementById('reportDetails').value;
      
      if (!reason) {
        alert('Por favor selecciona un motivo para el reporte');
        return;
      }
      
      // Simular envío del reporte
      closeReportArticleModal();
      showNotification('Reporte enviado. Gracias por ayudar a mantener la comunidad segura.', 'success');
    }

    // Cargar voces disponibles
    function loadAvailableVoices() {
      availableVoices = speechSynthesis.getVoices();
      
      // Si las voces no están cargadas, esperar el evento
      if (availableVoices.length === 0) {
        speechSynthesis.onvoiceschanged = () => {
          availableVoices = speechSynthesis.getVoices();
        };
      }
    }

    // Obtener mejor voz para el idioma
    function getBestVoiceForLanguage(lang) {
      if (availableVoices.length === 0) {
        loadAvailableVoices();
      }

      const voiceLangMap = {
        'es': ['es-ES', 'es-MX', 'es-AR', 'es'],
        'en': ['en-US', 'en-GB', 'en-AU', 'en'],
        'pt': ['pt-BR', 'pt-PT', 'pt'],
        'ko': ['ko-KR', 'ko'],
        'vi': ['vi-VN', 'vi'],
        'zh': ['zh-CN', 'zh-TW', 'zh'],
        'ja': ['ja-JP', 'ja'],
        'fr': ['fr-FR', 'fr-CA', 'fr'],
        'de': ['de-DE', 'de'],
        'it': ['it-IT', 'it'],
        'ru': ['ru-RU', 'ru']
      };

      const preferredLangs = voiceLangMap[lang] || [lang];
      
      // Buscar voz nativa preferida
      for (const prefLang of preferredLangs) {
        const voice = availableVoices.find(v => 
          v.lang.toLowerCase().startsWith(prefLang.toLowerCase()) && 
          v.localService
        );
        if (voice) return voice;
      }
      
      // Buscar cualquier voz del idioma
      for (const prefLang of preferredLangs) {
        const voice = availableVoices.find(v => 
          v.lang.toLowerCase().startsWith(prefLang.toLowerCase())
        );
        if (voice) return voice;
      }
      
      // Fallback a voz por defecto
      return availableVoices.find(v => v.default) || availableVoices[0] || null;
    }

    // Traducir texto usando Google Translate API gratuita
    async function translateArticleText(text, targetLang) {
      if (targetLang === 'es') return text;
      
      try {
        const chunks = text.match(/.{1,4500}/g) || [text]; // Dividir en chunks para evitar límites
        let translatedText = '';
        
        for (const chunk of chunks) {
          const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=es&tl=${targetLang}&dt=t&q=${encodeURIComponent(chunk)}`;
          
          const response = await fetch(url);
          if (!response.ok) throw new Error(`Error HTTP: ${response.status}`);
          
          const result = await response.json();
          
          if (result && result[0] && Array.isArray(result[0])) {
            result[0].forEach(item => {
              if (item && item[0]) {
                translatedText += item[0];
              }
            });
          }
          
          // Pequeña pausa entre requests para no sobrecargar la API
          await new Promise(resolve => setTimeout(resolve, 100));
        }
        
        return translatedText || text;
      } catch (error) {
        console.error('Error de traducción:', error);
        return text; // Retornar texto original si falla
      }
    }

    // Función para leer artículo con voz mejorada y traducción
    async function toggleArticleReader() {
      const readerBtn = document.getElementById('readerArticle');
      const readerIcon = document.getElementById('readerIcon');
      const readerText = document.getElementById('readerText');
      
      if (!speechSynthesis) {
        showNotification('La síntesis de voz no está disponible en este navegador', 'error');
        return;
      }
      
      if (isReading) {
        stopReading();
      } else {
        await startReading();
      }
    }

    async function startReading() {
      // Obtener texto del artículo
      const articleTitle = document.getElementById('articleTitle').textContent;
      const articleBody = document.getElementById('articleBody').textContent;
      
      // Crear texto completo
      let fullText = `${articleTitle}. ${articleBody}`;
      
      if (fullText.trim() === '') {
        showNotification('No hay contenido para leer', 'info');
        return;
      }
      
      // Detener cualquier lectura anterior
      speechSynthesis.cancel();
      
      // Cargar voces si no están disponibles
      if (availableVoices.length === 0) {
        loadAvailableVoices();
        await new Promise(resolve => setTimeout(resolve, 500)); // Esperar a que se carguen
      }
      
      // Determinar idioma objetivo
      const targetLang = currentLang === 'es' ? 'es' : currentLang;
      
      // Mostrar indicador de procesamiento
      updateReaderButton(true, 'Procesando...');
      
      try {
        // Traducir si es necesario
        if (targetLang !== 'es') {
          isTranslating = true;
          showNotification(`🌐 Traduciendo artículo a ${getLanguageName(targetLang)}...`, 'info');
          
          fullText = await translateArticleText(fullText, targetLang);
          
          isTranslating = false;
          showNotification(`✅ Artículo traducido a ${getLanguageName(targetLang)}`, 'success');
        }
        
        // Obtener mejor voz para el idioma
        const selectedVoice = getBestVoiceForLanguage(targetLang);
        
        // Crear nueva síntesis de voz
        currentUtterance = new SpeechSynthesisUtterance(fullText);
        
        // Configurar voz y parámetros mejorados
        if (selectedVoice) {
          currentUtterance.voice = selectedVoice;
          currentUtterance.lang = selectedVoice.lang;
          console.log(`Usando voz: ${selectedVoice.name} (${selectedVoice.lang})`);
        } else {
          const voiceLangs = {
            'es': 'es-ES',
            'en': 'en-US',
            'pt': 'pt-BR',
            'ko': 'ko-KR',
            'vi': 'vi-VN',
            'zh': 'zh-CN',
            'ja': 'ja-JP',
            'fr': 'fr-FR',
            'de': 'de-DE',
            'it': 'it-IT',
            'ru': 'ru-RU'
          };
          currentUtterance.lang = voiceLangs[targetLang] || 'es-ES';
        }
        
        // Configurar parámetros de voz optimizados
        currentUtterance.rate = 0.85; // Velocidad más natural
        currentUtterance.pitch = 1.1; // Tono ligeramente más alto
        currentUtterance.volume = 0.9; // Volumen óptimo
        
        // Eventos de la síntesis de voz
        currentUtterance.onstart = function() {
          isReading = true;
          updateReaderButton(true, 'Leyendo...');
          const voiceName = selectedVoice ? selectedVoice.name : 'Voz del sistema';
          showNotification(`📢 Iniciando lectura con ${voiceName}`, 'info');
        };
        
        currentUtterance.onend = function() {
          isReading = false;
          updateReaderButton(false);
          showNotification('✅ Lectura completada', 'success');
        };
        
        currentUtterance.onerror = function(event) {
          isReading = false;
          updateReaderButton(false);
          showNotification('❌ Error durante la lectura: ' + event.error, 'error');
          console.error('Error de síntesis de voz:', event.error);
        };
        
        currentUtterance.onpause = function() {
          isReading = false;
          updateReaderButton(false);
        };
        
        currentUtterance.onresume = function() {
          isReading = true;
          updateReaderButton(true, 'Leyendo...');
        };
        
        // Iniciar lectura
        speechSynthesis.speak(currentUtterance);
        
      } catch (error) {
        console.error('Error al procesar artículo para lectura:', error);
        showNotification('❌ Error al procesar el artículo', 'error');
        isReading = false;
        isTranslating = false;
        updateReaderButton(false);
      }
    }
    
    // Función auxiliar para obtener nombre del idioma
    function getLanguageName(lang) {
      const languageNames = {
        'es': 'Español',
        'en': 'Inglés',
        'pt': 'Portugués',
        'ko': '한국어',
        'vi': 'Tiếng Việt',
        'zh': '中文',
        'ja': '日本語',
        'fr': 'Français',
        'de': 'Deutsch',
        'it': 'Italiano',
        'ru': 'Русский'
      };
      return languageNames[lang] || lang.toUpperCase();
    }

    function stopReading() {
      if (speechSynthesis && currentUtterance) {
        speechSynthesis.cancel();
        isReading = false;
        isTranslating = false;
        updateReaderButton(false);
        showNotification('⏸️ Lectura detenida', 'info');
      }
    }

    function updateReaderButton(reading, customText = null) {
      const readerBtn = document.getElementById('readerArticle');
      const readerIcon = document.getElementById('readerIcon');
      const readerText = document.getElementById('readerText');
      
      if (reading) {
        readerBtn.classList.add('reading');
        if (isTranslating) {
          readerIcon.className = 'fas fa-language';
          readerText.textContent = customText || 'Traduciendo...';
        } else {
          readerIcon.className = 'fas fa-stop';
          readerText.textContent = customText || 'Detener';
        }
      } else {
        readerBtn.classList.remove('reading');
        readerIcon.className = 'fas fa-volume-up';
        readerText.textContent = 'Lector';
      }
    }

    // Función para pausar/reanudar lectura cuando se cierra el artículo
    function closeArticleOverlay() {
      const overlay = document.getElementById('articleOverlay');
      
      // Detener lectura si está activa
      if (isReading) {
        stopReading();
      }
      
      overlay.style.display = 'none';
      document.body.style.overflow = 'auto';
    }

    /* ========================
       Funciones de Reporte de Video
       ======================== */
    function openReportModal() { document.getElementById('reportModal').style.display = 'flex'; }
    function closeReportModal() { document.getElementById('reportModal').style.display = 'none'; }
    function submitReport() {
      alert("Reporte enviado. Pronto se revisará el reporte.");
      closeReportModal();
    }

    /*************************************************
     *    EVENTOS AL CARGAR LA PÁGINA
     *************************************************/
    function updateLineNumbers(editor, lineNumbersElement) {
      const lines = editor.value.split('\n').length;
      let lineNumbers = [];
      for (let i = 1; i <= lines; i++) {
        lineNumbers.push(i);
      }
      lineNumbersElement.textContent = lineNumbers.join('\n');

      // Ajustar el ancho según el número de dígitos
      const maxDigits = String(lines).length;
      lineNumbersElement.style.width = (maxDigits * 10 + 25) + 'px';
    }

    function updateSyntaxHighlight(editor, highlightElement, language) {
      let code = editor.value;

      // Patrones básicos de resaltado
      const patterns = {
        keyword: /\b(function|return|const|let|var|if|else|for|while|class|import|export|default|async|await)\b/g,
        string: /"([^"\\]|\\.)*"|'([^'\\]|\\.)*'/g,
        number: /\b\d+(\.\d+)?\b/g,
        function: /\b\w+(?=\()/g,
        comment: /\/\/.*|\/\*[\s\S]*?\*\//g
      };

      // Aplicar resaltado
      let highlighted = code;
      for (const [type, pattern] of Object.entries(patterns)) {
        highlighted = highlighted.replace(pattern, match => 
          `<span class="${type}">${match}</span>`
        );
      }

      highlightElement.innerHTML = highlighted;
    }

    // Funciones de herramientas de vista previa
function initPreviewTools() {
  let currentZoom = 1;
  const frame = document.getElementById('previewFrame');

  document.getElementById('zoomInBtn').addEventListener('click', () => {
    currentZoom = Math.min(currentZoom + 0.1, 2);
    frame.style.transform = `scale(${currentZoom})`;
  });

  document.getElementById('zoomOutBtn').addEventListener('click', () => {
    currentZoom = Math.max(currentZoom - 0.1, 0.5);
    frame.style.transform = `scale(${currentZoom})`;
  });

  document.getElementById('scanBtn').addEventListener('click', () => {
    const scanAnimation = document.getElementById('scanAnimation');
    const scanResults = scanAnimation.querySelector('.scan-results');
    scanAnimation.style.display = 'block';

    // Create particles container
    const particles = document.createElement('div');
    particles.className = 'particles';
    scanAnimation.appendChild(particles);

    // Generate particles
    function createParticle(x, y) {
      const particle = document.createElement('div');
      particle.className = 'particle';
      particle.style.left = x + 'px';
      particle.style.top = y + 'px';
      particle.style.width = Math.random() * 4 + 2 + 'px';
      particle.style.height = particle.style.width;
      particles.appendChild(particle);

      setTimeout(() => particle.remove(), 2000);
    }

    // Analyze code sections
    const codeElements = [
      { elem: htmlEditor, type: 'HTML' },
      { elem: cssEditor, type: 'CSS' },
      { elem: jsEditor, type: 'JavaScript' }
    ];

    let currentElement = 0;
    let totalIssues = 0;
    let progress = 0;

    scanResults.style.display = 'block';
    scanResults.innerHTML = `
      <h3>Análisis de Seguridad en Tiempo Real</h3>
      <p>Iniciando escaneo...</p>
      <div class="progress"></div>
    `;

    const analyzeInterval = setInterval(() => {
      if (currentElement < codeElements.length) {
        const { elem, type } = codeElements[currentElement];
        const code = elem.value;

        // Create floating particles
        for (let i = 0; i < 3; i++) {
          createParticle(
            Math.random() * scanAnimation.offsetWidth,
            Math.random() * scanAnimation.offsetHeight
          );
        }

        // Simulate code analysis
        let issues = [];
        if (type === 'HTML') {
          if (code.includes('<script>')) issues.push('Script inline detectado');
          if (!code.includes('<!DOCTYPE html>')) issues.push('Falta DOCTYPE');
        } else if (type === 'CSS') {
          if (code.includes('!important')) issues.push('Uso de !important');
        } else if (type === 'JavaScript') {
          if (code.includes('eval(')) issues.push('Uso de eval()');
        }

        totalIssues += issues.length;
        progress = Math.min(100, ((currentElement + 1) / codeElements.length) * 100);

        scanResults.innerHTML = `
          <h3>Análisis de Seguridad en Tiempo Real</h3>
          <p>Analizando ${type}...</p>
          <div class="progress">Progreso: ${Math.floor(progress)}%</div>
          <div class="issues">Problemas encontrados: ${totalIssues}</div>
          ${issues.length ? '<ul>' + issues.map(i => `<li>${i}</li>`).join('') + '</ul>' : ''}
        `;

        currentElement++;
      } else {
        clearInterval(analyzeInterval);

        scanResults.innerHTML = `
          <h3>Análisis Completado ✓</h3>
          <p>${totalIssues > 0 ? `Se encontraron ${totalIssues} problemas` : 'No se encontraron amenazas'}</p>
          <p>Archivos analizados: ${codeElements.length}</p>
          <p>Seguridad general: ${totalIssues === 0 ? '100%' : Math.max(0, 100 - totalIssues * 10) + '%'}</p>
        `;

        setTimeout(() => {
          particles.remove();
          scanAnimation.style.display = 'none';
          scanResults.style.display = 'none';
        }, 3000);
      }
    }, 1000);
  });
}
    /* ========================
       Funciones de Navegación entre Secciones
       ======================== */
    function showSection(sectionName) {
      // Ocultar todas las secciones
      document.querySelectorAll('.section').forEach(section => {
        section.classList.remove('active');
      });

      // Mostrar la sección seleccionada
      document.getElementById(sectionName).classList.add('active');

      // Actualizar navegación activa
      document.querySelectorAll('nav a').forEach(link => {
        link.classList.remove('active');
      });
      event.target.classList.add('active');
    }

    /* ========================
       Funciones de Proyectos
       ======================== */
    let currentProjectId = null;

    function createNewProject() {
      const projectName = prompt('Nombre del nuevo proyecto:');
      if (!projectName) return;

      const newProject = {
        id: Date.now(),
        name: projectName,
        html: '',
        css: '',
        js: '',
        createdAt: new Date().toISOString()
      };

      let projects = loadProjects();
      projects.push(newProject);
      saveProjects(projects);
      
      loadProject(newProject.id);
      renderProjectsList();
      document.getElementById('projectEditor').style.display = 'block';
    }

    function saveProject() {
      if (!currentProjectId) {
        alert('No hay proyecto activo para guardar');
        return;
      }

      // Mostrar skeleton de guardado
      showProjectActionSkeleton('save');

      const projectName = document.getElementById('projectName').value;
      const htmlCode = document.getElementById('htmlEditor').value;
      const cssCode = document.getElementById('cssEditor').value;
      const jsCode = document.getElementById('jsEditor').value;

      // Simular delay de guardado
      setTimeout(() => {
        let projects = loadProjects();
        const projectIndex = projects.findIndex(p => p.id === currentProjectId);
        
        if (projectIndex !== -1) {
          projects[projectIndex] = {
            ...projects[projectIndex],
            name: projectName,
            html: htmlCode,
            css: cssCode,
            js: jsCode,
            updatedAt: new Date().toISOString()
          };
          
          saveProjects(projects);
          renderProjectsList();
          hideProjectActionSkeleton();
          
          // Mostrar notificación de guardado exitoso
          const notification = document.createElement('div');
          notification.style.cssText = `
            position: fixed;
            top: 20px;
            right: 20px;
            background: #4CAF50;
            color: white;
            padding: 15px 20px;
            border-radius: 5px;
            z-index: 10000;
            font-weight: 600;
          `;
          notification.textContent = `Proyecto "${projectName}" guardado exitosamente`;
          document.body.appendChild(notification);
          
          setTimeout(() => {
            notification.remove();
          }, 3000);
        }
      }, 800);
    }

    function loadProject(projectId) {
      const projects = loadProjects();
      const project = projects.find(p => p.id === projectId);
      
      if (project) {
        currentProjectId = projectId;
        document.getElementById('projectName').value = project.name;
        document.getElementById('htmlEditor').value = project.html || '';
        document.getElementById('cssEditor').value = project.css || '';
        document.getElementById('jsEditor').value = project.js || '';
        
        // Actualizar números de línea y resaltado
        updateLineNumbers(document.getElementById('htmlEditor'), document.getElementById('htmlLineNumbers'));
        updateLineNumbers(document.getElementById('cssEditor'), document.getElementById('cssLineNumbers'));
        updateLineNumbers(document.getElementById('jsEditor'), document.getElementById('jsLineNumbers'));
        
        document.getElementById('projectEditor').style.display = 'block';
      }
    }

    function duplicateProject() {
      if (!currentProjectId) {
        alert('No hay proyecto activo para duplicar');
        return;
      }
      
      // Mostrar skeleton de duplicado
      showProjectActionSkeleton('duplicate');
      
      const projects = loadProjects();
      const project = projects.find(p => p.id === currentProjectId);
      
      if (project) {
        // Simular delay de duplicado
        setTimeout(() => {
          const newProject = {
            ...project,
            id: Date.now(),
            name: project.name + ' - Copia',
            createdAt: new Date().toISOString()
          };
          
          projects.push(newProject);
          saveProjects(projects);
          renderProjectsList();
          hideProjectActionSkeleton();
          showNotification('Proyecto duplicado exitosamente', 'success');
        }, 1200);
      }
    }

    function exportProject() {
      if (!currentProjectId) {
        alert('No hay proyecto activo para exportar');
        return;
      }
      
      // Mostrar skeleton de exportación
      showProjectActionSkeleton('export');
      
      const projects = loadProjects();
      const project = projects.find(p => p.id === currentProjectId);
      
      if (project) {
        // Simular delay de exportación
        setTimeout(() => {
          const exportData = {
            name: project.name,
            html: project.html || '',
            css: project.css || '',
            js: project.js || '',
            exportDate: new Date().toISOString()
          };
          
          const blob = new Blob([JSON.stringify(exportData, null, 2)], { type: 'application/json' });
          const url = URL.createObjectURL(blob);
          const a = document.createElement('a');
          a.href = url;
          a.download = `${project.name}.json`;
          a.click();
          URL.revokeObjectURL(url);
          
          hideProjectActionSkeleton();
          showNotification('Proyecto exportado exitosamente', 'success');
        }, 1000);
      }
    }

    function formatAllCode() {
      try {
        // Obtener el editor activo dependiendo de la sección
        const currentSection = document.querySelector('.section.active').id;
        let htmlEditor, cssEditor, jsEditor;
        
        if (currentSection === 'proyectos') {
          htmlEditor = document.getElementById('htmlEditor');
          cssEditor = document.getElementById('cssEditor');
          jsEditor = document.getElementById('jsEditor');
        } else {
          htmlEditor = document.getElementById('htmlEditorMain');
          cssEditor = document.getElementById('cssEditorMain');
          jsEditor = document.getElementById('jsEditorMain');
        }
        
        let formatted = false;
        
        if (htmlEditor && htmlEditor.value.trim()) {
          const originalValue = htmlEditor.value;
          htmlEditor.value = formatHTML(htmlEditor.value);
          if (originalValue !== htmlEditor.value) formatted = true;
          updateLineNumbers(htmlEditor, document.getElementById(htmlEditor.id.replace('Editor', 'LineNumbers')));
        }
        
        if (cssEditor && cssEditor.value.trim()) {
          const originalValue = cssEditor.value;
          cssEditor.value = formatCSS(cssEditor.value);
          if (originalValue !== cssEditor.value) formatted = true;
          updateLineNumbers(cssEditor, document.getElementById(cssEditor.id.replace('Editor', 'LineNumbers')));
        }
        
        if (jsEditor && jsEditor.value.trim()) {
          const originalValue = jsEditor.value;
          jsEditor.value = formatJS(jsEditor.value);
          if (originalValue !== jsEditor.value) formatted = true;
          updateLineNumbers(jsEditor, document.getElementById(jsEditor.id.replace('Editor', 'LineNumbers')));
        }
        
        if (formatted) {
          showNotification('Código formateado exitosamente', 'success');
        } else {
          showNotification('No hay código para formatear', 'info');
        }
      } catch (error) {
        console.error('Error al formatear:', error);
        showNotification('Error al formatear el código', 'error');
      }
    }

    function formatHTML(html) {
      if (!html || html.trim() === '') return html;
      
      // Formatear HTML básico
      let formatted = html.trim();
      
      // Añadir DOCTYPE si no existe
      if (!formatted.toLowerCase().includes('<!doctype')) {
        formatted = '<!DOCTYPE html>\n' + formatted;
      }
      
      // Formatear tags
      formatted = formatted
        .replace(/></g, '>\n<')
        .replace(/(<\/[^>]+>)/g, '$1\n')
        .replace(/(<[^/>]+>)/g, '$1\n')
        .replace(/\n\s*\n/g, '\n')
        .trim();
      
      // Indentar
      const lines = formatted.split('\n');
      let indentLevel = 0;
      const indentedLines = lines.map(line => {
        const trimmed = line.trim();
        if (trimmed === '') return '';
        
        if (trimmed.startsWith('</')) {
          indentLevel = Math.max(0, indentLevel - 1);
        }
        
        const indented = '  '.repeat(indentLevel) + trimmed;
        
        if (trimmed.startsWith('<') && !trimmed.startsWith('</') && !trimmed.endsWith('/>') && !['<br>', '<hr>', '<img', '<input', '<meta', '<link'].some(tag => trimmed.toLowerCase().startsWith(tag))) {
          indentLevel++;
        }
        
        return indented;
      });
      
      return indentedLines.join('\n');
    }

    function formatCSS(css) {
      if (!css || css.trim() === '') return css;
      
      let formatted = css.trim();
      
      // Formatear CSS
      formatted = formatted
        .replace(/\s*{\s*/g, ' {\n  ')
        .replace(/;\s*/g, ';\n  ')
        .replace(/\s*}\s*/g, '\n}\n\n')
        .replace(/,\s*/g, ',\n')
        .replace(/\n\s*\n\s*\n/g, '\n\n')
        .trim();
      
      return formatted;
    }

    function formatJS(js) {
      if (!js || js.trim() === '') return js;
      
      let formatted = js.trim();
      
      // Formatear JavaScript básico
      formatted = formatted
        .replace(/\s*{\s*/g, ' {\n  ')
        .replace(/;\s*/g, ';\n  ')
        .replace(/\s*}\s*/g, '\n}\n\n')
        .replace(/,\s*/g, ', ')
        .replace(/\)\s*{/g, ') {\n  ')
        .replace(/\n\s*\n\s*\n/g, '\n\n')
        .trim();
      
      return formatted;
    }

    function findAndReplace() {
      const searchTerm = prompt('¿Qué quieres buscar?');
      if (!searchTerm || searchTerm.trim() === '') {
        showNotification('Búsqueda cancelada', 'info');
        return;
      }
      
      const replaceTerm = prompt('¿Con qué lo quieres reemplazar?');
      if (replaceTerm === null) {
        showNotification('Reemplazo cancelado', 'info');
        return;
      }
      
      // Determinar qué editores usar
      const currentSection = document.querySelector('.section.active').id;
      let editors;
      
      if (currentSection === 'proyectos') {
        editors = ['htmlEditor', 'cssEditor', 'jsEditor'];
      } else {
        editors = ['htmlEditorMain', 'cssEditorMain', 'jsEditorMain'];
      }
      
      let totalReplacements = 0;
      let editorsModified = [];
      
      editors.forEach(editorId => {
        const editor = document.getElementById(editorId);
        if (editor && editor.value) {
          const originalValue = editor.value;
          const regex = new RegExp(searchTerm.replace(/[.*+?^${}()|[\]\\]/g, '\\$&'), 'g');
          const replacements = (originalValue.match(regex) || []).length;
          
          if (replacements > 0) {
            editor.value = originalValue.replace(regex, replaceTerm);
            totalReplacements += replacements;
            editorsModified.push(editorId.replace('Editor', '').replace('Main', '').toUpperCase());
            
            // Actualizar números de línea
            const lineNumbersId = editorId.replace('Editor', 'LineNumbers');
            const lineNumbersElement = document.getElementById(lineNumbersId);
            if (lineNumbersElement) {
              updateLineNumbers(editor, lineNumbersElement);
            }
          }
        }
      });
      
      if (totalReplacements > 0) {
        showNotification(`${totalReplacements} reemplazos en ${editorsModified.join(', ')}`, 'success');
      } else {
        showNotification(`No se encontró "${searchTerm}"`, 'info');
      }
    }

    function validateCode() {
      const currentSection = document.querySelector('.section.active').id;
      let htmlEditor, cssEditor, jsEditor;
      
      if (currentSection === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      let issues = [];
      let warnings = [];
      
      // Validación HTML
      if (htmlEditor && htmlEditor.value.trim()) {
        const htmlContent = htmlEditor.value;
        
        if (!htmlContent.toLowerCase().includes('<!doctype')) {
          issues.push('HTML: Falta declaración DOCTYPE');
        }
        
        if (!htmlContent.includes('<html')) {
          warnings.push('HTML: Se recomienda usar tag <html>');
        }
        
        if (!htmlContent.includes('<head>')) {
          warnings.push('HTML: Se recomienda usar tag <head>');
        }
        
        if (!htmlContent.includes('<body>')) {
          warnings.push('HTML: Se recomienda usar tag <body>');
        }
        
        // Verificar tags sin cerrar
        const openTags = (htmlContent.match(/<[a-zA-Z][^/>]*[^/]>/g) || []).length;
        const closeTags = (htmlContent.match(/<\/[a-zA-Z][^>]*>/g) || []).length;
        const selfClosing = (htmlContent.match(/<[^>]*\/>/g) || []).length;
        
        if (openTags - selfClosing !== closeTags) {
          issues.push('HTML: Tags HTML desbalanceados');
        }
      }
      
      // Validación CSS
      if (cssEditor && cssEditor.value.trim()) {
        const cssContent = cssEditor.value;
        const openBraces = (cssContent.match(/{/g) || []).length;
        const closeBraces = (cssContent.match(/}/g) || []).length;
        
        if (openBraces !== closeBraces) {
          issues.push('CSS: Llaves desbalanceadas');
        }
        
        if (cssContent.includes('!important')) {
          warnings.push('CSS: Uso excesivo de !important');
        }
      }
      
      // Validación JavaScript
      if (jsEditor && jsEditor.value.trim()) {
        const jsContent = jsEditor.value;
        
        const openParens = (jsContent.match(/\(/g) || []).length;
        const closeParens = (jsContent.match(/\)/g) || []).length;
        if (openParens !== closeParens) {
          issues.push('JS: Paréntesis desbalanceados');
        }
        
        const openBrackets = (jsContent.match(/\[/g) || []).length;
        const closeBrackets = (jsContent.match(/\]/g) || []).length;
        if (openBrackets !== closeBrackets) {
          issues.push('JS: Corchetes desbalanceados');
        }
        
        const openBraces = (jsContent.match(/{/g) || []).length;
        const closeBraces = (jsContent.match(/}/g) || []).length;
        if (openBraces !== closeBraces) {
          issues.push('JS: Llaves desbalanceadas');
        }
        
        if (jsContent.includes('eval(')) {
          warnings.push('JS: Uso de eval() puede ser peligroso');
        }
      }
      
      // Mostrar resultados
      let message = '';
      if (issues.length === 0 && warnings.length === 0) {
        showNotification('✅ Código validado - Sin errores detectados', 'success');
      } else {
        if (issues.length > 0) {
          message += '❌ ERRORES:\n' + issues.join('\n') + '\n\n';
        }
        if (warnings.length > 0) {
          message += '⚠️ ADVERTENCIAS:\n' + warnings.join('\n');
        }
        
        // Crear modal personalizado para mostrar resultados
        const modal = document.createElement('div');
        modal.style.cssText = `
          position: fixed; top: 0; left: 0; width: 100%; height: 100%;
          background: rgba(0,0,0,0.8); z-index: 10000; display: flex;
          align-items: center; justify-content: center; padding: 20px;
        `;
        
        const content = document.createElement('div');
        content.style.cssText = `
          background: white; padding: 30px; border-radius: 10px;
          max-width: 500px; max-height: 70vh; overflow-y: auto;
          color: #333; text-align: left;
        `;
        
        content.innerHTML = `
          <h3 style="margin-bottom: 20px; color: #1877f2;">Resultados de Validación</h3>
          <pre style="white-space: pre-wrap; font-family: Arial, sans-serif;">${message}</pre>
          <button style="background: #1877f2; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; margin-top: 20px;" onclick="this.parentElement.parentElement.remove()">Cerrar</button>
        `;
        
        modal.appendChild(content);
        document.body.appendChild(modal);
      }
    }

    function clearAllEditors() {
      const currentSection = document.querySelector('.section.active').id;
      let htmlEditor, cssEditor, jsEditor;
      
      if (currentSection === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      if (confirm('¿Estás seguro de que quieres limpiar todo el código?')) {
        let cleared = false;
        
        if (htmlEditor) {
          htmlEditor.value = '';
          updateLineNumbers(htmlEditor, document.getElementById(htmlEditor.id.replace('Editor', 'LineNumbers')));
          cleared = true;
        }
        if (cssEditor) {
          cssEditor.value = '';
          updateLineNumbers(cssEditor, document.getElementById(cssEditor.id.replace('Editor', 'LineNumbers')));
          cleared = true;
        }
        if (jsEditor) {
          jsEditor.value = '';
          updateLineNumbers(jsEditor, document.getElementById(jsEditor.id.replace('Editor', 'LineNumbers')));
          cleared = true;
        }
        
        if (cleared) {
          showNotification('Editores limpiados exitosamente', 'success');
        }
      }
    }

    function shareProject() {
      if (!currentProjectId) {
        alert('No hay proyecto activo para compartir');
        return;
      }
      
      const shareUrl = `${window.location.origin}${window.location.pathname}?project=${currentProjectId}`;
      navigator.clipboard.writeText(shareUrl).then(() => {
        showNotification('Enlace copiado al portapapeles', 'success');
      }).catch(() => {
        prompt('Copia este enlace para compartir:', shareUrl);
      });
    }

    function showProjectSettings() {
      alert('Configuraciones del proyecto - Función en desarrollo');
    }

    function toggleFullscreen() {
      const editor = document.getElementById('projectEditor');
      if (editor.classList.contains('fullscreen')) {
        editor.classList.remove('fullscreen');
        document.querySelector('.fullscreen-btn i').className = 'fas fa-expand';
      } else {
        editor.classList.add('fullscreen');
        document.querySelector('.fullscreen-btn i').className = 'fas fa-compress';
      }
    }

    let undoStack = [];
    let redoStack = [];
    let maxUndoSteps = 20;

    function saveState() {
      const currentSection = document.querySelector('.section.active').id;
      const state = getCurrentState();
      
      // Solo guardar si hay cambios
      if (undoStack.length === 0 || JSON.stringify(state) !== JSON.stringify(undoStack[undoStack.length - 1])) {
        undoStack.push(state);
        if (undoStack.length > maxUndoSteps) {
          undoStack.shift();
        }
        redoStack = []; // Limpiar redo stack cuando se hace un nuevo cambio
      }
    }

    function undoChanges() {
      if (undoStack.length > 1) {
        const currentState = getCurrentState();
        redoStack.push(currentState);
        undoStack.pop(); // Remover estado actual
        const previousState = undoStack[undoStack.length - 1];
        restoreState(previousState);
        showNotification('Cambio deshecho ↶', 'info');
      } else {
        showNotification('No hay más cambios para deshacer', 'info');
      }
    }

    function redoChanges() {
      if (redoStack.length > 0) {
        const state = redoStack.pop();
        undoStack.push(getCurrentState());
        restoreState(state);
        showNotification('Cambio rehecho ↷', 'info');
      } else {
        showNotification('No hay más cambios para rehacer', 'info');
      }
    }

    function getCurrentState() {
      const currentSection = document.querySelector('.section.active').id;
      let htmlEditor, cssEditor, jsEditor;
      
      if (currentSection === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      return {
        html: htmlEditor ? htmlEditor.value : '',
        css: cssEditor ? cssEditor.value : '',
        js: jsEditor ? jsEditor.value : '',
        section: currentSection
      };
    }

    function restoreState(state) {
      let htmlEditor, cssEditor, jsEditor;
      
      if (state.section === 'proyectos') {
        htmlEditor = document.getElementById('htmlEditor');
        cssEditor = document.getElementById('cssEditor');
        jsEditor = document.getElementById('jsEditor');
      } else {
        htmlEditor = document.getElementById('htmlEditorMain');
        cssEditor = document.getElementById('cssEditorMain');
        jsEditor = document.getElementById('jsEditorMain');
      }
      
      if (htmlEditor) {
        htmlEditor.value = state.html;
        updateLineNumbers(htmlEditor, document.getElementById(htmlEditor.id.replace('Editor', 'LineNumbers')));
      }
      if (cssEditor) {
        cssEditor.value = state.css;
        updateLineNumbers(cssEditor, document.getElementById(cssEditor.id.replace('Editor', 'LineNumbers')));
      }
      if (jsEditor) {
        jsEditor.value = state.js;
        updateLineNumbers(jsEditor, document.getElementById(jsEditor.id.replace('Editor', 'LineNumbers')));
      }
    }

    function showProjectActionSkeleton(action) {
      // Crear overlay de skeleton para acciones
      let skeleton = document.getElementById('projectActionSkeleton');
      
      if (!skeleton) {
        skeleton = document.createElement('div');
        skeleton.id = 'projectActionSkeleton';
        skeleton.style.cssText = `
          position: fixed;
          top: 50%;
          left: 50%;
          transform: translate(-50%, -50%);
          background: rgba(255,255,255,0.95);
          border-radius: 15px;
          padding: 30px;
          z-index: 11000;
          text-align: center;
          box-shadow: 0 10px 30px rgba(0,0,0,0.2);
          backdrop-filter: blur(10px);
          min-width: 200px;
        `;
        document.body.appendChild(skeleton);
      }
      
      const actionTexts = {
        'save': { icon: '💾', text: 'Guardando proyecto...' },
        'duplicate': { icon: '📁', text: 'Duplicando proyecto...' },
        'export': { icon: '📤', text: 'Exportando proyecto...' }
      };
      
      const actionData = actionTexts[action] || { icon: '⚙️', text: 'Procesando...' };
      
      skeleton.innerHTML = `
        <div style="font-size: 40px; margin-bottom: 15px; animation: pulse 2s infinite;">${actionData.icon}</div>
        <div style="color: #333; font-weight: 600; margin-bottom: 20px;">${actionData.text}</div>
        <div style="display: flex; gap: 5px; justify-content: center;">
          <div style="width: 8px; height: 8px; background: var(--primary-color); border-radius: 50%; animation: translatingPulse 1.4s infinite;"></div>
          <div style="width: 8px; height: 8px; background: var(--primary-color); border-radius: 50%; animation: translatingPulse 1.4s infinite; animation-delay: 0.2s;"></div>
          <div style="width: 8px; height: 8px; background: var(--primary-color); border-radius: 50%; animation: translatingPulse 1.4s infinite; animation-delay: 0.4s;"></div>
        </div>
      `;
      
      skeleton.style.display = 'block';
    }
    
    function hideProjectActionSkeleton() {
      const skeleton = document.getElementById('projectActionSkeleton');
      if (skeleton) {
        skeleton.style.display = 'none';
      }
    }

    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        padding: 12px 20px;
        border-radius: 5px;
        z-index: 10000;
        font-weight: 600;
        color: white;
        background: ${type === 'success' ? '#4CAF50' : type === 'error' ? '#f44336' : '#2196F3'};
      `;
      notification.textContent = message;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    function deleteProject(projectId) {
      if (confirm('¿Estás seguro de que quieres eliminar este proyecto?')) {
        let projects = loadProjects();
        projects = projects.filter(p => p.id !== projectId);
        saveProjects(projects);
        renderProjectsList();
        
        if (currentProjectId === projectId) {
          closeProject();
        }
      }
    }

    function closeProject() {
      currentProjectId = null;
      document.getElementById('projectEditor').style.display = 'none';
      document.getElementById('projectName').value = '';
      document.getElementById('htmlEditor').value = '';
      document.getElementById('cssEditor').value = '';
      document.getElementById('jsEditor').value = '';
    }
    function loadProjects() {
      const storedProjects = localStorage.getItem('projects');
      return storedProjects ? JSON.parse(storedProjects) : [];
    }
    function saveProjects(projects) {
      localStorage.setItem('projects', JSON.stringify(projects));
    }
    function renderProjectsList() {
      const projects = loadProjects();
      const projectsList = document.getElementById('projectsList');
      projectsList.innerHTML = "";

      projects.forEach(project => {
        const projectDiv = document.createElement('div');
        projectDiv.style.cssText = `
          display: flex;
          align-items: center;
          gap: 5px;
          margin-bottom: 5px;
        `;

        const button = document.createElement('button');
        button.classList.add('project-btn');
        button.textContent = project.name;
        button.style.flex = '1';
        
        button.addEventListener('click', () => {
          loadProject(project.id);
        });

        const deleteBtn = document.createElement('button');
        deleteBtn.innerHTML = '<i class="fas fa-trash"></i>';
        deleteBtn.style.cssText = `
          background: #ff4444;
          color: white;
          border: none;
          padding: 5px 8px;
          border-radius: 3px;
          cursor: pointer;
          font-size: 12px;
        `;
        deleteBtn.addEventListener('click', (e) => {
          e.stopPropagation();
          deleteProject(project.id);
        });

        projectDiv.appendChild(button);
        projectDiv.appendChild(deleteBtn);
        projectsList.appendChild(projectDiv);
      });
    }

document.addEventListener('DOMContentLoaded', () => {
      // Cargar idioma guardado desde localStorage
      const savedLang = localStorage.getItem('currentLang');
      if (savedLang) {
        currentLang = savedLang;
        console.log(`Idioma cargado desde localStorage: ${currentLang}`);
      }
      
      // Cargar voces disponibles
      loadAvailableVoices();
      
      // Aplicar idioma sin animación al cargar
      const t = translations[currentLang] || translations["es"];
      updateAllTexts(t);
      
      checkSession();
      setupSwipeDetection();
      renderRecentSearches();
      renderProjectsList();
      updateThemeDisplay();
      
      // Inicializar eventos del overlay de artículos
      document.getElementById('closeArticle').addEventListener('click', closeArticleOverlay);
      document.getElementById('followAuthor').addEventListener('click', toggleFollow);
      document.getElementById('likeArticle').addEventListener('click', toggleArticleLike);
      document.getElementById('bookmarkArticle').addEventListener('click', toggleBookmark);
      document.getElementById('readerArticle').addEventListener('click', toggleArticleReader);
      document.getElementById('reportArticle').addEventListener('click', openReportArticleModal);
      
      // Eventos del modal de reporte
      document.getElementById('closeReportModal').addEventListener('click', closeReportArticleModal);
      document.getElementById('cancelReport').addEventListener('click', closeReportArticleModal);
      document.getElementById('submitArticleReport').addEventListener('click', submitArticleReport);

      // Elementos de Clack
      const codeEffect = document.querySelector('.code-effect');
      const settingsBtn = document.getElementById('settingsBtn');
      const previewBtn = document.getElementById('previewBtn');
      const closePreview = document.getElementById('closePreview');
      const previewFrame = document.getElementById('previewFrame');
      const htmlEditor = document.getElementById('htmlEditor');
      const cssEditor = document.getElementById('cssEditor');
      const jsEditor = document.getElementById('jsEditor');
      const searchBtn = document.getElementById('searchBtn');
      const closeSearchOverlay = document.getElementById('closeSearchOverlay');
      const searchExecuteBtn = document.getElementById('searchExecuteBtn');
      const toggleVideos = document.getElementById('toggleVideos');
      const toggleArticles = document.getElementById('toggleArticles');
      const likeVideoBtn = document.getElementById('likeVideoBtn');
      const reportVideoBtn = document.getElementById('reportVideoBtn');
      const closeVideoBtn = document.getElementById('closeVideoBtn');
      const likeAnimation = document.getElementById('likeAnimation');
      const submitReportBtn = document.getElementById('submitReport');

      const introSound = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAFhpbmcAAAAPAAAAAwAAA/wAVlZWVlZWVlZWVlZWVlZWVlZWVlZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2dnZ2v7+/v7+/v7+/v7+/v7+/v7+/v7//////////////////////////////////////////////////////////////////////////////////MAAAAxpMRFNBAAAAGgAAAAEAAAMYAAQGAkNhAAAQJAADBhgAABUWAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV');
      const typeSound = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAFhpbmcAAAAPAAAAAwAAA+UAVlZWVlZWVlZWVlZWVlZWVlZWVlZ8fHx8fHx8fHx8fHx8fHx8fHx8fHx8zMzMzMzMzMzMzMzMzMzMzMzMzMzM////////////////////////////////////////////////////////////////////////////////////////////////////////////MAAAAxpMRFNBAAAAHQAAAAEAAAN4AAQIBAMDAAAABQ4AAAMGGAAAFhYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV');
      const executeSound = new Audio('data:audio/mp3;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4Ljc2LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAFhpbmcAAAAPAAAAAwAAA/MAVlZWVlZWVlZWVlZWVlZWVlZWVlZ7e3t7e3t7e3t7e3t7e3t7e3t7e3t7ysrKysrKysrKysrKysrKysrKysrK////////////////////////////////////////////////////////////////////////////////////////////////////////////MAAAAxpMRFNBAAAAHQAAAAEAAANyAAQGAwIAAAAACw4AAAMGGAAAFRYAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAAAAANIAAAAAExBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV');

      introSound.volume = 0.5;
      introSound.play().catch(e => console.log('Error playing sound:', e));
      function generateRandomCode() {
        let code = '';
        const characters = '01';
        for (let i = 0; i < 1000; i++) {
          code += characters[Math.floor(Math.random() * characters.length)];
        }
        return code;
      }
      document.querySelector('.code-effect').textContent = generateRandomCode();
      setTimeout(() => {
        document.querySelector('.intro').style.animation = 'fadeOut 1s forwards';
        document.getElementById('loginModal').style.display = 'block';
      }, 2500);
      // Configurar editores principales y de proyectos
      const editors = [
        {editor: document.getElementById('htmlEditorMain'), lineNumbers: 'htmlLineNumbersMain', highlight: 'htmlHighlightMain'},
        {editor: document.getElementById('cssEditorMain'), lineNumbers: 'cssLineNumbersMain', highlight: 'cssHighlightMain'},
        {editor: document.getElementById('jsEditorMain'), lineNumbers: 'jsLineNumbersMain', highlight: 'jsHighlightMain'},
        {editor: document.getElementById('htmlEditor'), lineNumbers: 'htmlLineNumbers', highlight: 'htmlHighlight'},
        {editor: document.getElementById('cssEditor'), lineNumbers: 'cssLineNumbers', highlight: 'cssHighlight'},
        {editor: document.getElementById('jsEditor'), lineNumbers: 'jsLineNumbers', highlight: 'jsHighlight'}
      ];

      editors.forEach(({editor, lineNumbers, highlight}) => {
        if (editor) {
          const lineNumbersElement = document.getElementById(lineNumbers);
          const highlightElement = document.getElementById(highlight);

          // Guardar estado inicial
          setTimeout(() => saveState(), 100);

          editor.addEventListener('input', () => {
            updateLineNumbers(editor, lineNumbersElement);
            if (highlightElement) {
              updateSyntaxHighlight(editor, highlightElement, editor.id.includes('html') ? 'html' : editor.id.includes('css') ? 'css' : 'js');
            }
            
            // Guardar estado después de cambios (con debounce)
            clearTimeout(editor.saveStateTimeout);
            editor.saveStateTimeout = setTimeout(() => {
              saveState();
            }, 1000);
          });

          editor.addEventListener('scroll', () => {
            if (lineNumbersElement) lineNumbersElement.scrollTop = editor.scrollTop;
            if (highlightElement) highlightElement.scrollTop = editor.scrollTop;
          });

          editor.addEventListener('keydown', (e) => {
            const newTypeSound = typeSound.cloneNode();
            newTypeSound.volume = 0.3;
            newTypeSound.play().catch(e => console.log('Error playing sound:', e));
            
            // Atajos de teclado
            if (e.ctrlKey || e.metaKey) {
              switch(e.key.toLowerCase()) {
                case 'z':
                  if (e.shiftKey) {
                    e.preventDefault();
                    redoChanges();
                  } else {
                    e.preventDefault();
                    undoChanges();
                  }
                  break;
                case 'y':
                  e.preventDefault();
                  redoChanges();
                  break;
                case 'f':
                  e.preventDefault();
                  findAndReplace();
                  break;
                case 's':
                  e.preventDefault();
                  if (currentProjectId) {
                    saveProject();
                  } else {
                    showNotification('Proyecto guardado automáticamente', 'info');
                  }
                  break;
              }
            }
            
            // Auto-completar brackets
            const cursor = editor.selectionStart;
            const value = editor.value;
            
            switch(e.key) {
              case '(':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '()' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case '[':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '[]' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case '{':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '{}' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case '"':
                e.preventDefault();
                editor.value = value.slice(0, cursor) + '""' + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
              case "'":
                e.preventDefault();
                editor.value = value.slice(0, cursor) + "''" + value.slice(cursor);
                editor.setSelectionRange(cursor + 1, cursor + 1);
                break;
            }
          });

          // Inicializar números de línea
          updateLineNumbers(editor, lineNumbersElement);
        }
      });

      // Inicializar selector de idiomas del chat
      function initChatLanguageSelector() {
        const chatLanguageBtn = document.getElementById('chatLanguageBtn');
        const chatLanguageDropdown = document.getElementById('chatLanguageDropdown');
        const currentChatLangSpan = document.getElementById('currentChatLang');
        
        if (chatLanguageBtn && chatLanguageDropdown) {
          // Mostrar/ocultar dropdown
          chatLanguageBtn.addEventListener('click', (e) => {
            e.stopPropagation();
            chatLanguageDropdown.classList.toggle('show');
          });
          
          // Cerrar dropdown al hacer clic fuera
          document.addEventListener('click', () => {
            chatLanguageDropdown.classList.remove('show');
          });
          
          // Manejar selección de idioma
          chatLanguageDropdown.addEventListener('click', async (e) => {
            const option = e.target.closest('.chat-lang-option');
            if (option) {
              const selectedLang = option.dataset.lang;
              currentChatLang = selectedLang;
              
              // Actualizar UI
              currentChatLangSpan.textContent = selectedLang.toUpperCase();
              
              // Marcar opción seleccionada
              document.querySelectorAll('.chat-lang-option').forEach(opt => {
                opt.classList.remove('selected');
              });
              option.classList.add('selected');
              
              chatLanguageDropdown.classList.remove('show');
              
              // Mostrar notificación de cambio de idioma
              const notification = document.createElement('div');
              notification.style.cssText = `
                position: fixed;
                bottom: 100px;
                left: 50%;
                transform: translateX(-50%);
                background: var(--primary-color);
                color: white;
                padding: 10px 20px;
                border-radius: 20px;
                z-index: 10000;
                font-size: 14px;
                animation: slideUp 0.3s ease;
              `;
              notification.innerHTML = `
                ${chatLanguages[selectedLang].flag} Idioma cambiado a ${chatLanguages[selectedLang].name}
              `;
              document.body.appendChild(notification);
              
              setTimeout(() => {
                notification.remove();
              }, 3000);
              
              // Traducir mensaje de bienvenida si es necesario
              if (selectedLang !== 'es') {
                const welcomeMessage = document.querySelector('.message.bot .message-content');
                if (welcomeMessage) {
                  const originalText = `¡Hola! 👋 Soy tu asistente virtual de Clack. Puedo ayudarte con:

• 💻 Funciones del editor de código
• 🎨 Personalización y temas
• 🔧 Gestión de proyectos
• 🚀 Vista previa y deployment
• 🛡️ Análisis de seguridad

¿En qué puedo ayudarte hoy?`;
                  
                  try {
                    const translatedText = await translateText(originalText, selectedLang);
                    welcomeMessage.innerHTML = `
                      ${translatedText}
                      <div class="message-time">${getCurrentTime()}</div>
                    `;
                  } catch (error) {
                    console.error('Error traduciendo mensaje de bienvenida:', error);
                  }
                }
              }
            }
          });
          
          // Inicializar idioma por defecto
          currentChatLangSpan.textContent = currentChatLang.toUpperCase();
          document.querySelector(`[data-lang="${currentChatLang}"]`)?.classList.add('selected');
        }
      }
      
      // Configurar botones de vista previa y escáner en proyectos
      const previewBtnProject = document.getElementById('previewBtnProject');
      const scanBtnProject = document.getElementById('scanBtnProject');

      if (previewBtnProject) {
        previewBtnProject.addEventListener('click', () => {
          executeSound.play();
          document.getElementById('previewOverlay').style.display = 'block';
          showPreviewSkeleton();
          runScanAnimation();
          setTimeout(() => {
            hidePreviewSkeleton();
            const htmlCode = document.getElementById('htmlEditor').value;
            const cssCode = document.getElementById('cssEditor').value;
            const jsCode = document.getElementById('jsEditor').value;
            
            const combinedCode = `
              <!DOCTYPE html>
              <html>
                <head>
                  <meta charset="UTF-8">
                  <style>${cssCode}</style>
                </head>
                <body>
                  ${htmlCode}
                  <script>${jsCode}<\/script>
                </body>
              </html>
            `;
            previewFrame.srcdoc = combinedCode;
          }, 3000);
        });
      }

      if (scanBtnProject) {
        scanBtnProject.addEventListener('click', () => {
          const scanAnimation = document.getElementById('scanAnimation');
          const scanResults = scanAnimation.querySelector('.scan-results');
          scanAnimation.style.display = 'block';

          // Create particles container
          const particles = document.createElement('div');
          particles.className = 'particles';
          scanAnimation.appendChild(particles);

          // Generate particles
          function createParticle(x, y) {
            const particle = document.createElement('div');
            particle.className = 'particle';
            particle.style.left = x + 'px';
            particle.style.top = y + 'px';
            particle.style.width = Math.random() * 4 + 2 + 'px';
            particle.style.height = particle.style.width;
            particles.appendChild(particle);

            setTimeout(() => particle.remove(), 2000);
          }

          // Analyze code sections from project editors
          const codeElements = [
            { elem: document.getElementById('htmlEditor'), type: 'HTML' },
            { elem: document.getElementById('cssEditor'), type: 'CSS' },
            { elem: document.getElementById('jsEditor'), type: 'JavaScript' }
          ];

          let currentElement = 0;
          let totalIssues = 0;
          let progress = 0;

          scanResults.style.display = 'block';
          scanResults.innerHTML = `
            <h3>Análisis de Seguridad en Tiempo Real</h3>
            <p>Iniciando escaneo...</p>
            <div class="progress"></div>
          `;

          const analyzeInterval = setInterval(() => {
            if (currentElement < codeElements.length) {
              const { elem, type } = codeElements[currentElement];
              const code = elem.value;

              // Create floating particles
              for (let i = 0; i < 3; i++) {
                createParticle(
                  Math.random() * scanAnimation.offsetWidth,
                  Math.random() * scanAnimation.offsetHeight
                );
              }

              // Simulate code analysis
              let issues = [];
              if (type === 'HTML') {
                if (code.includes('<script>')) issues.push('Script inline detectado');
                if (!code.includes('<!DOCTYPE html>')) issues.push('Falta DOCTYPE');
              } else if (type === 'CSS') {
                if (code.includes('!important')) issues.push('Uso de !important');
              } else if (type === 'JavaScript') {
                if (code.includes('eval(')) issues.push('Uso de eval()');
              }

              totalIssues += issues.length;
              progress = Math.min(100, ((currentElement + 1) / codeElements.length) * 100);

              scanResults.innerHTML = `
                <h3>Análisis de Seguridad en Tiempo Real</h3>
                <p>Analizando ${type}...</p>
                <div class="progress">Progreso: ${Math.floor(progress)}%</div>
                <div class="issues">Problemas encontrados: ${totalIssues}</div>
                ${issues.length ? '<ul>' + issues.map(i => `<li>${i}</li>`).join('') + '</ul>' : ''}
              `;

              currentElement++;
            } else {
              clearInterval(analyzeInterval);

              scanResults.innerHTML = `
                <h3>Análisis Completado ✓</h3>
                <p>${totalIssues > 0 ? `Se encontraron ${totalIssues} problemas` : 'No se encontraron amenazas'}</p>
                <p>Archivos analizados: ${codeElements.length}</p>
                <p>Seguridad general: ${totalIssues === 0 ? '100%' : Math.max(0, 100 - totalIssues * 10) + '%'}</p>
              `;

              setTimeout(() => {
                particles.remove();
                scanAnimation.style.display = 'none';
                scanResults.style.display = 'none';
              }, 3000);
            }
          }, 1000);
        });
      }
      // Función de tema movida a ajustes
      initPreviewTools();
      previewBtn.addEventListener('click', () => {
        executeSound.play();
        document.getElementById('previewOverlay').style.display = 'block';
        showPreviewSkeleton();
        runScanAnimation();
        setTimeout(() => {
          hidePreviewSkeleton();
          const htmlCode = document.getElementById('htmlEditorMain').value;
          const cssCode = document.getElementById('cssEditorMain').value;
          const jsCode = document.getElementById('jsEditorMain').value;
          
          const combinedCode = `
            <!DOCTYPE html>
            <html>
              <head>
                <meta charset="UTF-8">
                <style>${cssCode}</style>
              </head>
              <body>
                ${htmlCode}
                <script>${jsCode}<\/script>
              </body>
            </html>
          `;
          previewFrame.srcdoc = combinedCode;
        }, 3000);
      });
      closePreview.addEventListener('click', () => {
        document.getElementById('previewOverlay').style.display = 'none';
      });
      settingsBtn.addEventListener('click', () => {
        const overlay = document.getElementById('settingsOverlay');
        overlay.style.display = 'block';
        overlay.classList.add('show');
        updateCurrentLanguageDisplay();
      });
      
      // Cerrar ajustes
      document.getElementById('closeSettings').addEventListener('click', () => {
        const overlay = document.getElementById('settingsOverlay');
        overlay.style.display = 'none';
        overlay.classList.remove('show');
      });
      
      // Abrir submenu de idiomas
      document.getElementById('languageSettingsItem').addEventListener('click', () => {
        document.getElementById('languageSubmenu').classList.add('show');
        updateLanguageSelection();
      });
      
      // Volver a ajustes desde idiomas
      document.getElementById('backToSettings').addEventListener('click', () => {
        document.getElementById('languageSubmenu').classList.remove('show');
      });
      
      // Manejar selección de idioma
      document.querySelectorAll('.language-option').forEach(option => {
        option.addEventListener('click', (e) => {
          const lang = e.currentTarget.getAttribute('data-lang');
          updateLanguage(lang);
          updateLanguageSelection();
          updateCurrentLanguageDisplay();
          
          // Volver a ajustes después de 500ms
          setTimeout(() => {
            document.getElementById('languageSubmenu').classList.remove('show');
          }, 500);
        });
      });
      
      // Manejar cambio de tema desde ajustes
      document.getElementById('themeSettingsItem').addEventListener('click', () => {
        document.body.classList.toggle('dark-mode');
        updateThemeDisplay();
      });
      
      // Abrir bot de ayuda
      document.getElementById('helpBotItem').addEventListener('click', () => {
        document.getElementById('helpBotOverlay').classList.add('show');
        document.getElementById('settingsOverlay').style.display = 'none';
        initHelpBot();
        initChatLanguageSelector();
      });
      
      // Cerrar bot de ayuda
      document.getElementById('closeHelpBot').addEventListener('click', () => {
        document.getElementById('helpBotOverlay').classList.remove('show');
      });
      
      // Función para actualizar la visualización del idioma actual
      function updateCurrentLanguageDisplay() {
        const languageNames = {
          'es': 'Español',
          'en': 'English', 
          'ja': '日本語',
          'ko': '한국어',
          'vi': 'Tiếng Việt',
          'zh': '中文'
        };
        document.getElementById('currentLanguageText').textContent = languageNames[currentLang] || 'Español';
      }
      
      // Función para actualizar la selección visual en el submenu de idiomas
      function updateLanguageSelection() {
        document.querySelectorAll('.language-option').forEach(option => {
          const check = option.querySelector('.check');
          if (option.getAttribute('data-lang') === currentLang) {
            option.classList.add('selected');
            check.style.display = 'block';
          } else {
            option.classList.remove('selected');
            check.style.display = 'none';
          }
        });
      }
      
      // Función para actualizar la visualización del tema
      function updateThemeDisplay() {
        const isDark = document.body.classList.contains('dark-mode');
        document.getElementById('currentThemeText').textContent = isDark ? 'Oscuro' : 'Claro';
        document.getElementById('themeIcon').className = isDark ? 'fas fa-sun' : 'fas fa-moon';
      }
      
      // Bot de Ayuda - Base de conocimientos
      const botKnowledge = {
        'crear proyecto': 'Para crear un nuevo proyecto: 1️⃣ Ve a la sección "Proyectos", 2️⃣ Haz clic en "Nuevo Proyecto", 3️⃣ Escribe el nombre y ¡listo! 🎉',
        'cambiar tema': 'Para cambiar el tema: 1️⃣ Abre Ajustes ⚙️, 2️⃣ Selecciona "Tema", 3️⃣ El tema cambiará automáticamente entre claro y oscuro. 🌙☀️',
        'escáner': 'El escáner de seguridad 🛡️ analiza tu código buscando vulnerabilidades. Solo haz clic en el botón "Escanear" en la vista previa.',
        'exportar': 'Para exportar: 1️⃣ Abre tu proyecto, 2️⃣ Haz clic en "Exportar" 📥, 3️⃣ Se descargará un archivo JSON con tu código.',
        'atajos': 'Atajos útiles: Ctrl+S (guardar), Ctrl+Z (deshacer), Ctrl+Y (rehacer), Ctrl+F (buscar y reemplazar). ⌨️',
        'vista previa': 'La vista previa 👁️ muestra cómo se ve tu código en tiempo real. Incluye zoom y análisis de seguridad.',
        'proyectos': 'En la sección Proyectos puedes crear, editar, duplicar y exportar tus códigos. Todo se guarda automáticamente. 💾',
        'idioma': 'Puedes cambiar el idioma en Ajustes > Idioma. Soportamos Español, Inglés, Japonés, Coreano, Vietnamita y Chino. 🌍'
      };
      
      function initHelpBot() {
        // Establecer tiempo de bienvenida
        document.getElementById('welcomeTime').textContent = getCurrentTime();
        
        // Configurar área de chat
        const chatInput = document.getElementById('chatInput');
        const sendButton = document.getElementById('sendButton');
        
        // Auto-resize del textarea
        chatInput.addEventListener('input', () => {
          chatInput.style.height = 'auto';
          chatInput.style.height = (chatInput.scrollHeight) + 'px';
          
          // Habilitar/deshabilitar botón de envío
          sendButton.disabled = chatInput.value.trim() === '';
        });
        
        // Enviar mensaje
        const sendMessage = () => {
          const message = chatInput.value.trim();
          if (message) {
            addUserMessage(message);
            chatInput.value = '';
            chatInput.style.height = 'auto';
            sendButton.disabled = true;
            
            // Simular respuesta del bot
            setTimeout(() => {
              showTypingIndicator();
              setTimeout(() => {
                hideTypingIndicator();
                addBotMessage(getBotResponse(message));
              }, 1500);
            }, 500);
          }
        };
        
        sendButton.addEventListener('click', sendMessage);
        chatInput.addEventListener('keypress', (e) => {
          if (e.key === 'Enter' && !e.shiftKey) {
            e.preventDefault();
            sendMessage();
          }
        });
      }
      
      function getCurrentTime() {
        return new Date().toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
      }
      
      function addUserMessage(message) {
        const chatMessages = document.getElementById('chatMessages');
        const messageDiv = document.createElement('div');
        messageDiv.className = 'message user';
        messageDiv.innerHTML = `
          <div class="message-content">
            ${message}
            <div class="message-time">${getCurrentTime()}</div>
          </div>
        `;
        chatMessages.appendChild(messageDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      
      async function addBotMessage(message) {
        const chatMessages = document.getElementById('chatMessages');
        
        console.log(`Idioma actual del chat: ${currentChatLang}`);
        console.log(`Mensaje original: ${message}`);
        
        // Si no es español, mostrar skeleton y traducir
        if (currentChatLang !== 'es') {
          // Mostrar skeleton mientras se traduce
          const skeletonDiv = document.createElement('div');
          skeletonDiv.className = 'message bot';
          skeletonDiv.innerHTML = `
            <div class="message-skeleton">
              <div class="skeleton-line"></div>
              <div class="skeleton-line"></div>
              <div class="skeleton-line"></div>
              <div class="translating-indicator">
                <i class="fas fa-language"></i>
                <span>Traduciendo a ${chatLanguages[currentChatLang] ? chatLanguages[currentChatLang].name : currentChatLang}...</span>
                <div class="translating-dots">
                  <div class="translating-dot"></div>
                  <div class="translating-dot"></div>
                  <div class="translating-dot"></div>
                </div>
              </div>
            </div>
          `;
          chatMessages.appendChild(skeletonDiv);
          chatMessages.scrollTop = chatMessages.scrollHeight;
          
          try {
            console.log('Iniciando traducción...');
            
            // Simular delay mínimo para mostrar la animación
            await new Promise(resolve => setTimeout(resolve, 800));
            
            // Traducir el mensaje
            const translatedMessage = await translateText(message, currentChatLang);
            console.log(`Mensaje traducido: ${translatedMessage}`);
            
            // Remover skeleton y mostrar mensaje traducido
            skeletonDiv.remove();
            
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `
              <div class="message-content">
                ${translatedMessage}
                <div class="message-time">${getCurrentTime()}</div>
              </div>
            `;
            chatMessages.appendChild(messageDiv);
            
            // Mostrar notificación de éxito
            if (translatedMessage !== message) {
              console.log('✅ Traducción exitosa');
            }
            
          } catch (error) {
            console.error('Error en traducción:', error);
            // Si falla la traducción, mostrar mensaje original
            skeletonDiv.remove();
            const messageDiv = document.createElement('div');
            messageDiv.className = 'message bot';
            messageDiv.innerHTML = `
              <div class="message-content">
                ${message}
                <div class="message-time">${getCurrentTime()}</div>
                <small style="color: #999; font-style: italic; display: block; margin-top: 5px;">
                  💬 Mensaje en español (Error de traducción)
                </small>
              </div>
            `;
            chatMessages.appendChild(messageDiv);
          }
        } else {
          // Mostrar directamente en español
          const messageDiv = document.createElement('div');
          messageDiv.className = 'message bot';
          messageDiv.innerHTML = `
            <div class="message-content">
              ${message}
              <div class="message-time">${getCurrentTime()}</div>
            </div>
          `;
          chatMessages.appendChild(messageDiv);
        }
        
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      
      function showTypingIndicator() {
        const chatMessages = document.getElementById('chatMessages');
        const typingDiv = document.createElement('div');
        typingDiv.id = 'typingIndicator';
        typingDiv.className = 'message bot';
        typingDiv.innerHTML = `
          <div class="typing-indicator">
            <div class="typing-dots">
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
              <div class="typing-dot"></div>
            </div>
            <span style="margin-left: 8px; color: #666; font-size: 12px;">Escribiendo...</span>
          </div>
        `;
        chatMessages.appendChild(typingDiv);
        chatMessages.scrollTop = chatMessages.scrollHeight;
      }
      
      function hideTypingIndicator() {
        const typingIndicator = document.getElementById('typingIndicator');
        if (typingIndicator) {
          typingIndicator.remove();
        }
      }
      
      // Sistema de traducción mejorado usando Google Translate API gratuita
      async function translateText(text, targetLang) {
        // Si el idioma objetivo es español, no traducir
        if (targetLang === 'es') {
          return text;
        }
        
        try {
          console.log(`Traduciendo: "${text}" a idioma: ${targetLang}`);
          
          // Usar Google Translate API gratuita
          const url = `https://translate.googleapis.com/translate_a/single?client=gtx&sl=es&tl=${targetLang}&dt=t&q=${encodeURIComponent(text)}`;
          
          const response = await fetch(url);
          
          if (!response.ok) {
            throw new Error(`Error HTTP: ${response.status}`);
          }
          
          const result = await response.json();
          console.log('Resultado de traducción:', result);
          
          // Extraer texto traducido
          if (result && result[0] && Array.isArray(result[0])) {
            let translatedText = '';
            result[0].forEach(item => {
              if (item && item[0]) {
                translatedText += item[0];
              }
            });
            
            if (translatedText) {
              console.log(`Texto traducido: "${translatedText}"`);
              return translatedText;
            }
          }
          
          // Si no se pudo traducir, usar traducciones predefinidas
          return getPredefnedTranslation(text, targetLang);
          
        } catch (error) {
          console.error('Error de traducción:', error);
          // Fallback a traducciones predefinidas
          return getPredefnedTranslation(text, targetLang);
        }
      }
      
      // Traducciones predefinidas para mensajes comunes
      function getPredefnedTranslation(text, targetLang) {
        const translations = {
          en: {
            'crear proyecto': 'create project',
            'cambiar tema': 'change theme',
            'escáner': 'scanner',
            'exportar': 'export',
            'atajos': 'shortcuts',
            'vista previa': 'preview',
            'proyectos': 'projects',
            'idioma': 'language',
            '¡Hola! 👋 Soy tu asistente virtual de Clack.': 'Hello! 👋 I am your Clack virtual assistant.',
            'Puedo ayudarte con:': 'I can help you with:',
            '• 💻 Funciones del editor de código': '• 💻 Code editor functions',
            '• 🎨 Personalización y temas': '• 🎨 Customization and themes',
            '• 🔧 Gestión de proyectos': '• 🔧 Project management',
            '• 🚀 Vista previa y deployment': '• 🚀 Preview and deployment',
            '• 🛡️ Análisis de seguridad': '• 🛡️ Security analysis',
            '¿En qué puedo ayudarte hoy?': 'How can I help you today?'
          },
          pt: {
            'crear proyecto': 'criar projeto',
            'cambiar tema': 'mudar tema',
            'escáner': 'scanner',
            'exportar': 'exportar',
            'atajos': 'atalhos',
            'vista previa': 'visualização',
            'proyectos': 'projetos',
            'idioma': 'idioma',
            '¡Hola! 👋 Soy tu asistente virtual de Clack.': 'Olá! 👋 Eu sou seu assistente virtual do Clack.',
            'Puedo ayudarte con:': 'Posso ajudá-lo com:',
            '• 💻 Funciones del editor de código': '• 💻 Funções do editor de código',
            '• 🎨 Personalización y temas': '• 🎨 Personalização e temas',
            '• 🔧 Gestión de proyectos': '• 🔧 Gestão de projetos',
            '• 🚀 Vista previa y deployment': '• 🚀 Visualização e implementação',
            '• 🛡️ Análisis de seguridad': '• 🛡️ Análise de segurança',
            '¿En qué puedo ayudarte hoy?': 'Como posso ajudá-lo hoje?'
          },
          ko: {
            'crear proyecto': '프로젝트 생성',
            'cambiar tema': '테마 변경',
            'escáner': '스캐너',
            'exportar': '내보내기',
            'atajos': '단축키',
            'vista previa': '미리보기',
            'proyectos': '프로젝트',
            'idioma': '언어',
            '¡Hola! 👋 Soy tu asistente virtual de Clack.': '안녕하세요! 👋 저는 Clack의 가상 어시스턴트입니다.',
            'Puedo ayudarte con:': '다음 사항으로 도움을 드릴 수 있습니다:',
            '• 💻 Funciones del editor de código': '• 💻 코드 편집기 기능',
            '• 🎨 Personalización y temas': '• 🎨 사용자 정의 및 테마',
            '• 🔧 Gestión de proyectos': '• 🔧 프로젝트 관리',
            '• 🚀 Vista previa y deployment': '• 🚀 미리보기 및 배포',
            '• 🛡️ Análisis de seguridad': '• 🛡️ 보안 분석',
            '¿En qué puedo ayudarte hoy?': '오늘 어떻게 도와드릴까요?'
          },
          vi: {
            'crear proyecto': 'tạo dự án',
            'cambiar tema': 'thay đổi chủ đề',
            'escáner': 'máy quét',
            'exportar': 'xuất',
            'atajos': 'phím tắt',
            'vista previa': 'xem trước',
            'proyectos': 'dự án',
            'idioma': 'ngôn ngữ',
            '¡Hola! 👋 Soy tu asistente virtual de Clack.': 'Xin chào! 👋 Tôi là trợ lý ảo Clack của bạn.',
            'Puedo ayudarte con:': 'Tôi có thể giúp bạn với:',
            '• 💻 Funciones del editor de código': '• 💻 Các chức năng của trình soạn thảo mã',
            '• 🎨 Personalización y temas': '• 🎨 Tùy chỉnh và chủ đề',
            '• 🔧 Gestión de proyectos': '• 🔧 Quản lý dự án',
            '• 🚀 Vista previa y deployment': '• 🚀 Xem trước và triển khai',
            '• 🛡️ Análisis de seguridad': '• 🛡️ Phân tích bảo mật',
            '¿En qué puedo ayudarte hoy?': 'Hôm nay tôi có thể giúp bạn điều gì?'
          }
        };
        
        const langTranslations = translations[targetLang];
        if (langTranslations) {
          // Buscar traducción exacta
          if (langTranslations[text]) {
            return langTranslations[text];
          }
          
          // Buscar traducciones parciales
          for (const [original, translated] of Object.entries(langTranslations)) {
            if (text.includes(original)) {
              return text.replace(original, translated);
            }
          }
        }
        
        // Si no hay traducción disponible, retornar texto original
        return text;
      }
      
      function getBotResponse(userMessage) {
        const message = userMessage.toLowerCase();
        
        // Buscar en la base de conocimientos
        for (const [keyword, response] of Object.entries(botKnowledge)) {
          if (message.includes(keyword)) {
            return response;
          }
        }
        
        // Respuestas contextuales
        if (message.includes('hola') || message.includes('hi')) {
          return '¡Hola! 👋 ¿En qué puedo ayudarte con Clack hoy?';
        }
        
        if (message.includes('gracias') || message.includes('thank')) {
          return '¡De nada! 😊 Estoy aquí para ayudarte cuando lo necesites.';
        }
        
        if (message.includes('error') || message.includes('problema')) {
          return '¿Puedes contarme más sobre el error? 🔍 Puedo ayudarte a identificar problemas comunes en el código o con las funciones de la app.';
        }
        
        if (message.includes('código') || message.includes('programar')) {
          return '¡Excelente! 💻 Clack tiene editores para HTML, CSS y JavaScript con resaltado de sintaxis, numeración de líneas y validación automática. ¿Necesitas ayuda con algo específico?';
        }
        
        // Respuesta por defecto
        return `🤔 Hmm, no estoy seguro de cómo ayudarte con eso específicamente. Pero puedo asistirte con:
        
        • Crear y gestionar proyectos
        • Usar las herramientas del editor
        • Configurar ajustes y temas
        • Vista previa y análisis de código
        
        ¿Hay algo específico que te gustaría saber?`;
      }
      
      async function askQuickQuestion(question) {
        // Mostrar indicador de carga si es necesario traducir
        if (currentChatLang !== 'es') {
          const chatInput = document.getElementById('chatInput');
          chatInput.value = '⏳ Traduciendo pregunta...';
          chatInput.disabled = true;
          
          try {
            const translatedQuestion = await translateText(question, currentChatLang);
            chatInput.value = translatedQuestion;
            chatInput.disabled = false;
            document.getElementById('sendButton').disabled = false;
            console.log(`Pregunta traducida: ${question} -> ${translatedQuestion}`);
          } catch (error) {
            console.error('Error traduciendo pregunta rápida:', error);
            chatInput.value = question; // Usar pregunta original si falla la traducción
            chatInput.disabled = false;
            document.getElementById('sendButton').disabled = false;
          }
        } else {
          document.getElementById('chatInput').value = question;
          document.getElementById('sendButton').disabled = false;
        }
      }
      
      // Búsqueda en ajustes
      document.getElementById('settingsSearch').addEventListener('input', (e) => {
        const searchTerm = e.target.value.toLowerCase();
        const items = document.querySelectorAll('.settings-item');
        
        items.forEach(item => {
          const title = item.querySelector('.settings-item-title')?.textContent.toLowerCase() || '';
          const subtitle = item.querySelector('.settings-item-subtitle')?.textContent.toLowerCase() || '';
          
          if (title.includes(searchTerm) || subtitle.includes(searchTerm)) {
            item.style.display = 'flex';
          } else {
            item.style.display = 'none';
          }
        });
      });
      document.getElementById('changeLangBtn').addEventListener('click', () => {
        document.getElementById('settingsOverlay').style.display = 'block';
      });
      
      document.getElementById("githubLoginBtn").addEventListener("click", loginSimulated);

      searchBtn.addEventListener('click', () => { 
        showSearchSkeleton();
        setTimeout(() => {
          hideSearchSkeleton();
        }, 1000);
        toggleSearchOverlay(true); 
      });
      closeSearchOverlay.addEventListener('click', () => { toggleSearchOverlay(false); });
      searchExecuteBtn.addEventListener('click', () => {
        showSearchSkeleton();
        setTimeout(() => {
          executeSearch();
          hideSearchSkeleton();
        }, 800);
      });

      // Mostrar/ocultar botón de limpiar según el contenido del input
      const searchInput = document.getElementById('searchInput');
      const clearSearch = document.getElementById('clearSearch');

      searchInput.addEventListener('input', () => {
        clearSearch.style.display = searchInput.value ? 'block' : 'none';
      });

      clearSearch.addEventListener('click', () => {
        searchInput.value = '';
        clearSearch.style.display = 'none';
      });
      toggleVideos.addEventListener('click', () => {
        toggleVideos.classList.add('active');
        toggleArticles.classList.remove('active');
        executeSearch();
      });
      toggleArticles.addEventListener('click', () => {
        toggleArticles.classList.add('active');
        toggleVideos.classList.remove('active');
        executeSearch();
      });
      likeVideoBtn.addEventListener('click', () => {
        likeAnimation.style.opacity = "1";
        likeAnimation.style.animation = "likePop 0.8s forwards";
        setTimeout(() => {
          likeAnimation.style.opacity = "0";
          likeAnimation.style.animation = "none";
        }, 900);
      });
      reportVideoBtn.addEventListener('click', openReportModal);
      closeVideoBtn.addEventListener('click', () => { toggleVideoPlayerOverlay(false); });
      submitReportBtn.addEventListener('click', submitReport);


    });
  </script>
</body>
</html>
